<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–°—Ç–∏–ª—å–Ω–æ–µ –º–µ–Ω—é —Å –≤–∫–ª–∞–¥–∫–∞–º–∏</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  /* –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ —à–∏—Ä–∏–Ω—ã */
  *, ::before, ::after {
    box-sizing: border-box;
  }
  
  :root{
    --gold1:#ffd700;
    --gold2:#d0aa5b;
    --panel-bg: linear-gradient(180deg,#4a4a4a 0%,#3a3a3a 100%);
    --glass: rgba(30,30,30,0.95);
  }
  html,body{height:100%;margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(180deg,#3a3a3a 0%,#2c2c2c 100%);color:#f5f5f5;}
  .app { display:flex; flex-direction:column; height:100vh; overflow:hidden; }
  .tabs { flex:1; padding:12px; box-sizing:border-box; padding-bottom:140px; overflow:auto; -webkit-overflow-scrolling:touch; }

  .tab { display:none; }
  .tab.active { display:block; }

  /* –∫–∞—Ä—Ç–æ—á–∫–∏ (–ø—Ä–µ–º–∏—É–º —Å—Ç–∏–ª—å) */
  .section-box{
    background: var(--panel-bg);
    border:1px solid rgba(255,255,255,0.04);
    border-radius:18px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.5), inset 0 0 10px rgba(255,255,255,0.03);
    padding:18px;
    max-width:420px;
    margin:14px auto;
    position:relative;
  }
  h3{ margin:0 0 10px; color:var(--gold2); font-size:20px; text-align:center; font-weight:600; letter-spacing:0.3px; }
  p { margin:0 0 12px; color:#d9d9d9; text-align:center; font-size:14px; }

  /* promo */
  .promo-input{ display:flex; gap:10px; justify-content:center; align-items:center; flex-wrap:wrap; }
  .promo-input input{
    width:180px;padding:12px;border-radius:10px;border:1px solid #777;background:#2f2f2f;color:#f5f5f5;text-align:center;outline:none;
  }
  .promo-input button{
    background:linear-gradient(180deg,var(--gold2),#b4873e); border:none;color:#fff;padding:11px 16px;border-radius:10px;font-weight:600;cursor:pointer;
    box-shadow:0 6px 18px rgba(180,140,60,0.15);
  }
  .promo-message{ text-align:center;margin-top:10px;font-weight:600; display:none; }



  /* ads */
  #ads-progress-bar{
    width:100%; height:14px; background:#2f2f2f; border-radius:8px; overflow:hidden; margin-top:10px;
  }
  #ads-progress-bar-inner{
    width:0%; height:100%; background:linear-gradient(90deg,var(--gold1),var(--gold2)); border-radius:8px; position:relative; overflow:hidden;
  }
  #ads-progress-bar-inner::before{ content:''; position:absolute; top:0; left:-50%; width:50%; height:100%; background:linear-gradient(120deg, rgba(255,255,255,0.35), rgba(255,255,255,0.07), rgba(255,255,255,0.35)); animation:shine 2s linear infinite; }
  @keyframes shine{ 0%{left:-50%}100%{left:100%} }

  .watch-btn{ width:100%; padding:12px 0; border-radius:12px; border:none; font-weight:600; cursor:pointer; color:#fff; background:linear-gradient(180deg,var(--gold1),var(--gold2)); box-shadow:0 6px 20px rgba(255,215,0,0.15); }

  /* balance row */
  .balance-top{ display:flex; justify-content:center; gap:14px; align-items:center; margin:6px 0 6px; }
  .balance-top img{ width:28px;height:28px; display:inline-block; filter:drop-shadow(0 4px 8px rgba(0,0,0,0.6)); }
  .balance-top .bal{ font-weight:700;color:var(--gold1); font-size:15px; min-width:36px; text-align:center; }

  /* riddle */
  .riddle-box{ background: linear-gradient(145deg,#ffd70022,#d0aa5b22); border-radius:16px; padding:14px; box-shadow:0 6px 18px rgba(208,170,91,0.06); color:var(--gold1); font-weight:600; text-align:center; }
  .riddle-input{ display:flex; justify-content:center; gap:10px; margin-top:10px; }
  .riddle-input input{ padding:10px;border-radius:10px;border:1px solid #777;background:#2f2f2f;color:#fff;text-align:center; width:180px; }
  .riddle-input button{ padding:10px 14px;border-radius:10px;border:none;background:linear-gradient(180deg,var(--gold1),var(--gold2));color:#111;font-weight:700;cursor:pointer; }

  /* coins animation */
  .fall-coin{ position:fixed; pointer-events:auto; z-index:9999; font-size:26px; user-select:none; text-shadow:0 0 8px rgba(255,215,0,0.6); }
  .fall-coin.ton{ text-shadow:0 0 8px rgba(180,180,180,0.6); }
  .fall-coin.usdt{ text-shadow:0 0 8px rgba(0,200,100,0.6); }

  /* tabs bottom */
  .tab-buttons{
    position:fixed; left:0; bottom:0; width:100%; display:flex; justify-content:space-around; align-items:center;
    background:var(--glass); padding:10px 8px; box-shadow:0 -8px 30px rgba(0,0,0,0.6); border-radius:16px 16px 0 0; z-index:200;
  }
  .tab-btn{ flex:1; background:none;border:none;color:var(--gold2); cursor:pointer; display:flex; flex-direction:column; align-items:center; gap:4px; padding:6px 6px; min-height:56px; }
  .tab-btn:focus{ outline:none; }
  .tab-btn .emoji{ font-size:30px; line-height:1; display:block; pointer-events:none; }
  .tab-btn .label{ font-size:12px; color:var(--gold2); }
  .tab-btn.active .emoji{ text-shadow:0 0 10px rgba(255,215,0,0.9); }
  .tab-btn.active .label{ color:var(--gold1); font-weight:700; }
  .tab-btn.active{ background:radial-gradient(circle at top, rgba(255,215,0,0.08), transparent); border-radius:12px; }

  @media (max-width:420px){
    .section-box{ margin:12px 10px; }
    .promo-input input, .riddle-input input{ width:130px; }
    .tab-btn .emoji{ font-size:26px; }
    .tab-btn .label{ font-size:11px; }
  }

  .ripple{ position:absolute; border-radius:50%; transform:translate(-50%, -50%); pointer-events:none; width:8px; height:8px; background: rgba(255,255,255,0.12); animation:ripple 400ms linear forwards; }
  @keyframes ripple{ to{ width:120px; height:120px; opacity:0; } }
  .msg { transition:opacity .25s ease; opacity:1; }

  /* Daily login box */
  #daily-login-box {
    background: linear-gradient(135deg,#ffd70022,#d0aa5b22);
    border:1px solid rgba(255,215,0,0.15);
    box-shadow: 0 8px 25px rgba(255,215,0,0.25);
    padding:16px;
  }
  #daily-login-btn {
    width:100%;
    padding:12px 0;
    border-radius:12px;
    background: linear-gradient(180deg,#ffd700,#d0aa5b);
    border:none;
    font-weight:600;
    cursor:pointer;
    margin-top:6px;
    color:#111;
    box-shadow:0 6px 20px rgba(255,215,0,0.5);
    font-size:16px;
    transition: transform 0.2s, box-shadow 0.2s;
  }
  #daily-login-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 20px rgba(255,215,0,0.8), 0 0 40px rgba(255,215,0,0.4);
  }
  .day-cell {
    width:50px; height:50px; background:#2f2f2f; border-radius:10px;
    text-align:center; color:#f5f5f5; font-size:12px;
    display:flex; flex-direction:column; justify-content:center; align-items:center;
    border:1px solid rgba(255,215,0,0.2); box-shadow: inset 0 0 8px rgba(255,215,0,0.05);
  }
  .day-cell.active { background: linear-gradient(180deg,#ffd700,#d0aa5b); color:#111; font-weight:700; border:1px solid #ffd700; box-shadow:0 0 10px rgba(255,215,0,0.7); }
  .day-cell img { width:18px; margin-bottom:2px; }

/* =========================
   –ü—Ä–µ–º–∏—É–º —Å—Ç–∏–ª—å –±–ª–æ–∫–∞
========================= */
.premium-section{
  background: linear-gradient(145deg,#303030,#252525); 
  border-radius:20px;
  padding:20px;
  margin:20px auto;
  max-width:480px; /* –ì–ª–∞–≤–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã */
  box-shadow: 0 8px 24px rgba(0,0,0,0.4), inset 0 0 10px rgba(255,255,255,0.03);
  font-family: 'Poppins', sans-serif;
  color: #f5f5f5; 
}

.premium-section h2{
  font-weight:700;
  margin-bottom:18px;
  color:var(--gold1);
  text-align:center;
}

.conversion{
  font-weight:600;
  display:flex;
  align-items:center;
  gap:6px;
  margin-bottom:12px;
  justify-content:center;
}

.coin-icon{
  width:20px;
  height:20px;
}

.withdraw-form input{
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border-radius:12px;
  border:2px solid #555;
  background:#1e1e1e;
  color:#f5f5f5;
  font-size:16px;
  font-weight:500;
}

.withdraw-form input.error-field{
  border-color:#E53935;
}

.amount-row{
  display:flex;
  gap:6px;
}

.amount-row input{
  flex:1;
}

.amount-row button{
  flex:none;
  background:linear-gradient(180deg,#ffd700,#d0aa5b);
  border:none;
  border-radius:12px;
  padding:10px 14px;
  font-weight:600;
  cursor:pointer;
}

.withdraw-form button#withdraw-btn{
  width:100%;
  background:linear-gradient(180deg,#ffd700,#d0aa5b);
  border:none;
  padding:14px 0;
  border-radius:16px;
  font-weight:700;
  font-size:16px;
  cursor:pointer;
  box-shadow:0 6px 20px rgba(255,215,0,0.5);
  margin-top:6px;
}

.withdraw-message{
  margin-top:8px;
  font-weight:600;
  min-height:20px;
  text-align:center;
}


/* –ê–Ω–∏–º–∞—Ü–∏—è DOGS */
.fall-dogscoin{
  position:fixed;
  pointer-events:none;
  z-index:9999;
  width:32px;
  height:32px;
  background-image:url('dogscoin.png');
  background-size:contain;
  background-repeat:no-repeat;
}

/* üíº –ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å –∫–æ—à–µ–ª—å–∫–∞ */
.wallet-container {
  text-align: center;
  padding: 25px;
  font-family: 'Poppins', sans-serif;
  color: #fff;
}

.wallet-title {
  font-size: 1.8em;
  font-weight: 600;
  margin-bottom: 25px;
  background: linear-gradient(90deg, #ffd700, #ffcc33);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 0 15px rgba(255,215,0,0.4);
}

.wallet-grid {
  display: flex;
  flex-direction: column;
  gap: 25px;
  align-items: center;
}

.wallet-card {
  position: relative;
  width: 90%;
  max-width: 420px;
  border-radius: 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px 25px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.15);
  box-shadow: 0 0 25px rgba(255,255,255,0.08);
  overflow: hidden;
  transition: 0.3s ease;
}

.wallet-card::before {
  content: "";
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle at top left, rgba(255,255,255,0.1), transparent 60%);
  transform: rotate(25deg);
}

.wallet-card:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 0 35px rgba(255,255,255,0.2);
}

.wallet-icon {
  width: 60px;
  height: 60px;
  z-index: 2;
}

.wallet-info {
  text-align: right;
  z-index: 2;
}

.wallet-name {
  display: block;
  font-size: 1.1em;
  font-weight: 600;
  opacity: 0.85;
}

.wallet-balance {
  font-size: 1.6em;
  font-weight: bold;
  letter-spacing: 0.5px;
  text-shadow: 0 0 8px rgba(255,255,255,0.2);
}

/* –¶–≤–µ—Ç–æ–≤—ã–µ —Ç–µ–º—ã –∫–∞—Ä—Ç–æ—á–µ–∫ */
.wallet-card.gold {
  /* –¢–µ–º–Ω—ã–π, –Ω–∞—Å—ã—â–µ–Ω–Ω—ã–π —Ñ–æ–Ω */
  background: linear-gradient(135deg, #383115, #1f1b0a);
  /* –Ø—Ä–∫–∞—è –∑–æ–ª–æ—Ç–∞—è —Ä–∞–º–∫–∞ */
  border: 1px solid #ffd700;
  /* –°–∏–ª—å–Ω–æ–µ –∑–æ–ª–æ—Ç–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ */
  box-shadow: 0 0 30px rgba(255, 215, 0, 0.4), inset 0 0 10px rgba(255,255,255,0.05);
}

.wallet-card.usdt {
  background: linear-gradient(135deg, #26a17b20, #1e7e6120);
  border: 1px solid #26a17b60;
}

.wallet-card.ton {
  background: linear-gradient(135deg, #0098ea20, #006bbd20);
  border: 1px solid #0098ea60;
}

/* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–∞–º–æ–≥–æ —á–∏—Å–ª–∞ –±–∞–ª–∞–Ω—Å–∞ –º–æ–Ω–µ—Ç (–Ω–æ–≤–æ–µ) */
.wallet-card.gold .wallet-balance {
    font-size: 1.8em; /* –ù–µ–º–Ω–æ–≥–æ –∫—Ä—É–ø–Ω–µ–µ */
    font-weight: 800; /* –ñ–∏—Ä–Ω–µ–µ */
    /* –ó–æ–ª–æ—Ç–æ–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è —Ç–µ–∫—Å—Ç–∞ —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º —Å–≤–µ—á–µ–Ω–∏—è */
    background: linear-gradient(90deg, #ffd700, #ffcc33);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 0 0 10px rgba(255,215,0,0.8);
}

/* =========================
   –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π (History)
========================= */
.history-section h2 {
    margin-bottom: 12px;
}
.filter-buttons {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 20px;
    flex-wrap: wrap; /* –†–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å –∫–Ω–æ–ø–æ–∫ –¥–ª—è —É–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
}
.filter-btn {
    padding: 8px 14px;
    border: 1px solid var(--gold2);
    border-radius: 12px;
    background: #252525;
    color: var(--gold2);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}
.filter-btn.active {
    background: linear-gradient(180deg, var(--gold1), var(--gold2));
    color: #111;
    border-color: var(--gold1);
    font-weight: 700;
    box-shadow: 0 4px 10px rgba(255,215,0,0.3);
}
.history-table-container {
    overflow-x: auto; /* –≠–¢–û –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
    width: 100%; /* –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –æ–Ω –Ω–µ —à–∏—Ä–µ —Ä–æ–¥–∏—Ç–µ–ª—è (.premium-section) */
    margin-top: 15px;
    -webkit-overflow-scrolling: touch; /* –î–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –Ω–∞ iOS */
}
.history-table {
    width: 100%;
    border-collapse: collapse;
    min-width: 450px; /* –°–ù–ò–ñ–ï–ù–û: –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏, –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å 100% –∏ —É–±—Ä–∞—Ç—å max-width —É td, –Ω–æ —Å–∫—Ä–æ–ª–ª –ª—É—á—à–µ */
    font-size: 12px;
    text-align: left;
}
.history-table th {
    color: var(--gold1);
    padding: 10px 8px;
    border-bottom: 2px solid var(--gold2);
    font-weight: 600;
    text-transform: uppercase;
    opacity: 0.8;
}
.history-table td {
    padding: 10px 8px;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    white-space: nowrap; /* –ó–∞–ø—Ä–µ—â–∞–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —à–∏—Ä–∏–Ω—É */
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 60px; /* –£–ú–ï–ù–¨–®–ï–ù–û –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞ */
}
.history-table tbody tr:hover {
    background: rgba(255,215,0,0.05);
}
.history-amount-plus { color: #4CAF50; font-weight: 600; }
.history-amount-minus { color: #F44336; font-weight: 600; }
.history-amount-neutral { color: #9E9E9E; }

/* –°–ö–†–´–¢–ò–ï –ö–û–õ–û–ù–û–ö –ù–ê –£–ó–ö–ò–• –≠–ö–†–ê–ù–ê–• */
@media (max-width: 380px) {
    /* –°–∫—Ä—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ "–ö–æ—à–µ–ª–µ–∫" –∏ "MEMO" –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞ */
    .history-table th:nth-child(5), 
    .history-table td:nth-child(5),
    .history-table th:nth-child(6), 
    .history-table td:nth-child(6) {
        display: none;
    }
    
    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É–º–µ–Ω—å—à–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É —Ç–∞–±–ª–∏—Ü—ã */
    .history-table {
        min-width: 100%; 
    }
}
@media (max-width: 420px) {
  /* –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º min-width –¥–ª—è .premium-section, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –æ—Ç—Å—Ç—É–ø—ã –±—ã–ª–∏ –º–µ–Ω—å—à–µ */
  .premium-section {
    padding: 15px; 
    margin: 15px 10px;
  }
}

/* ======================================================== */
/* –°–¢–ò–õ–¨: –ï–ñ–ï–î–ù–ï–í–ù–û–ï –ö–û–ú–ë–û (Daily Combo) */
/* ======================================================== */
.combo-card {
  width: 65px !important; 
  height: 80px !important;
  background: #252525 !important;
  border-radius: 15px !important;
  border: 2px solid var(--gold2) !important;
  box-shadow: 0 4px 15px rgba(0,0,0,0.4), inset 0 0 8px rgba(255,215,0,0.05) !important;
  transition: all 0.3s ease-in-out !important;
  position: relative !important;
  overflow: hidden !important;
  cursor: pointer !important;
  /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
  display: flex !important; 
  flex-direction: column !important; 
  justify-content: center !important; 
  align-items: center !important;
}

.combo-card:hover {
  transform: scale(1.08);
  border-color: var(--gold1) !important;
  box-shadow: 0 0 20px rgba(255,215,0,0.3), inset 0 0 10px rgba(255,215,0,0.1);
}

/* –≠–ª–µ–º–µ–Ω—Ç: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ */
.combo-card .symbol-display { 
    width: 85%; 
    height: 85%; 
    object-fit: contain; 
    z-index: 2; 
    border-radius: 8px; 
    pointer-events: none; 
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–∞–ª–æ–∂–µ–Ω–∏—è —Å –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º –∑–Ω–∞–∫–æ–º */
.combo-card .card-overlay {
  position: absolute !important;
  inset: 0 !important;
  background: rgba(0,0,0,0.9) !important;
  border-radius: 12px;
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
  font-size: 32px !important;
  color: var(--gold1) !important;
  transition: opacity 0.3s ease !important;
  box-shadow: inset 0 0 10px rgba(255,215,0,0.2);
}

/* –°–æ—Å—Ç–æ—è–Ω–∏–µ: –í—ã–±—Ä–∞–Ω–∞ (–±–µ–∑ overlay) */
.combo-card.selected .card-overlay {
  opacity: 0 !important;
  pointer-events: none !important;
}

/* –°–æ—Å—Ç–æ—è–Ω–∏–µ: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ */
.combo-card.correct {
  background: linear-gradient(135deg, #4CAF50, #2E7D32) !important;
  border-color: #A5D6A7 !important;
  box-shadow: 0 0 25px rgba(76, 175, 80, 0.6) !important;
  color: #fff !important;
}

/* –°–æ—Å—Ç–æ—è–Ω–∏–µ: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ */
.combo-card.incorrect {
  background: #401010 !important;
  border-color: #E53935 !important;
  box-shadow: 0 0 15px rgba(229, 57, 53, 0.4) !important;
  opacity: 1 !important;
}

/* –°–ï–¢–ö–ê 4 –ö–û–õ–û–ù–ö–ò –î–õ–Ø –ö–ê–†–¢–û–ß–ï–ö */
#combo-cards {
    display: grid !important; 
    grid-template-columns: repeat(4, 1fr) !important; 
    gap: 12px !important; 
    max-width: 350px !important; 
    margin: 15px auto !important; 
}
/* ======================================================== */

/* ============================================================
   üéÆ –ü–†–ï–ú–ò–£–ú –°–¢–ò–õ–¨: –ò–ì–†–´ (—Å—Ç–∞–∫–∞–Ω—á–∏–∫–∏, –∫—É–±–∏–∫–∏, –æ—Ä–µ–ª –∏ —Ä–µ—à–∫–∞, —Ä—É–ª–µ—Ç–∫–∞)
============================================================ */
#games-section {
  margin-top: 25px;
  background: linear-gradient(145deg,#303030,#252525);
  border-radius: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 0 10px rgba(255,255,255,0.05);
  padding: 20px 15px;
  max-width: 420px;
  margin-left: auto;
  margin-right: auto;
  text-align: center;
}
#games-section h3 {
  color: var(--gold1);
  font-weight: 700;
  text-shadow: 0 0 10px rgba(255,215,0,0.5);
  margin-bottom: 8px;
}
#games-section p {
  color: #ccc;
  font-size: 14px;
  margin-bottom: 16px;
}
.games-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 14px;
}
.game-card {
  background: linear-gradient(145deg,#3a3a3a,#2a2a2a);
  border: 1px solid rgba(255,215,0,0.15);
  border-radius: 16px;
  padding: 18px 0;
  color: var(--gold1);
  font-weight: 700;
  font-size: 15px;
  cursor: pointer;
  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
  transition: transform 0.2s, box-shadow 0.2s;
}
.game-card:hover {
  transform: scale(1.05);
  box-shadow: 0 0 25px rgba(255,215,0,0.3);
}

/* === –ú–æ–¥–∞–ª–∫–∞ —Å–∞–º–æ–π –∏–≥—Ä—ã === */
.game-modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  backdrop-filter: blur(6px);
  z-index: 9999;
  display: none;
  justify-content: center;
  align-items: center;
}
.game-modal-overlay.open {
  display: flex;
}
.game-modal-content {
  background: linear-gradient(160deg,#1a1a1a,#333);
  border: 2px solid var(--gold1);
  border-radius: 20px;
  padding: 25px;
  text-align: center;
  box-shadow: 0 0 40px rgba(255,215,0,0.6);
  width: 280px;
  height: 260px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}
.game-visual {
  width: 120px;
  height: 120px;
  margin-bottom: 10px;
  position: relative;
}
.game-status-text {
  font-weight: 600;
  color: var(--gold1);
  font-size: 16px;
  margin-top: 10px;
  animation: blink 1s infinite alternate;
}
@keyframes blink {
  from { opacity: 0.7; }
  to { opacity: 1; }
}

/* === –ê–Ω–∏–º–∞—Ü–∏–∏ –º–∏–Ω–∏-–∏–≥—Ä === */
.cups-container {
  position: relative;
  width: 200px;
  height: 80px;
}
.cup {
  position: absolute;
  bottom: 0;
  width: 40px;
  height: 60px;
  background: linear-gradient(180deg,#555,#222);
  border-radius: 10px 10px 0 0;
  box-shadow: 0 4px 10px rgba(0,0,0,0.6);
}
.coin-under {
  position: absolute;
  bottom: 5px;
  width: 20px;
  height: 20px;
  background: radial-gradient(circle at 30% 30%, gold, #b88a00);
  border-radius: 50%;
  left: 50px;
}
@keyframes shuffle {
  from { transform: translateX(0); }
  to { transform: translateX(120px); }
}
.cup.lift { animation: liftUp 1s forwards; }
@keyframes liftUp { to { transform: translateY(-40px); } }

.dice {
  width: 60px;
  height: 60px;
  background: #fff;
  color: #000;
  font-weight: 700;
  font-size: 32px;
  display: flex;
  justify-content: center;
  align-items: center;
  border-radius: 10px;
  box-shadow: 0 0 15px rgba(255,255,255,0.4);
}

.coin-flip {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: linear-gradient(180deg,#FFD700,#B8860B);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #000;
  font-weight: 700;
  font-size: 18px;
  box-shadow: 0 0 20px rgba(255,215,0,0.6);
}
.coin-flip.spinning {
  animation: coinSpin 0.6s linear infinite;
}
@keyframes coinSpin {
  from { transform: rotateY(0deg); }
  to { transform: rotateY(360deg); }
}

.roulette-wheel {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  border: 4px solid var(--gold1);
  background: conic-gradient(
    #ffcc00 0 30deg,
    #222 30deg 60deg,
    #ffcc00 60deg 90deg,
    #222 90deg 120deg,
    #ffcc00 120deg 150deg,
    #222 150deg 180deg,
    #ffcc00 180deg 210deg,
    #222 210deg 240deg,
    #ffcc00 240deg 270deg,
    #222 270deg 300deg,
    #ffcc00 300deg 330deg,
    #222 330deg 360deg
  );
  box-shadow: 0 0 30px rgba(255,215,0,0.4);
}

/* === –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞–≥—Ä–∞–¥—ã === */
.reward-modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.85);
  backdrop-filter: blur(8px);
  z-index: 10000;
  display: flex;
  justify-content: center;
  align-items: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}
.reward-modal-overlay.open {
  opacity: 1;
  pointer-events: auto;
}
.reward-content {
  background: linear-gradient(160deg,#1a1a1a,#333);
  border: 3px solid var(--gold1);
  border-radius: 20px;
  padding: 25px;
  text-align: center;
  box-shadow: 0 0 40px rgba(255,215,0,0.8);
  animation: pulse 1.5s infinite alternate;
  max-width: 320px;
}
.premium-title {
  font-size: 26px;
  font-weight: 800;
  color: var(--gold1);
  text-shadow: 0 0 12px rgba(255,215,0,0.6);
  margin-bottom: 12px;
}
.reward-amount {
  font-size: 22px;
  font-weight: 700;
  color: #fff;
  margin-top: 8px;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
}
.reward-icon {
  width: 48px;
  height: 48px;
  animation: spin 1.3s linear infinite;
  filter: drop-shadow(0 0 10px rgba(255,255,255,0.8));
}
@keyframes pulse {
  from { box-shadow: 0 0 30px rgba(255,215,0,0.7); }
  to { box-shadow: 0 0 45px rgba(255,215,0,1); }
}
@keyframes spin {
  to { transform: rotate(360deg); }
}
.close-reward-btn {
  margin-top: 20px;
  background: linear-gradient(180deg,#555,#333);
  color: #fff;
  border: none;
  border-radius: 10px;
  font-weight: 600;
  padding: 10px 20px;
  cursor: pointer;
  transition: opacity 0.2s ease;
}
.close-reward-btn:hover {
  opacity: 0.8;
}

/* === –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞–≥—Ä–∞–¥—ã === */
.reward-modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.85);
  backdrop-filter: blur(8px);
  z-index: 10000;
  display: flex;
  justify-content: center;
  align-items: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}
.reward-modal-overlay.open {
  opacity: 1;
  pointer-events: auto;
}
.reward-content {
  background: linear-gradient(160deg,#1a1a1a,#333);
  border: 3px solid var(--gold1);
  border-radius: 20px;
  padding: 25px;
  text-align: center;
  box-shadow: 0 0 40px rgba(255,215,0,0.8);
  animation: pulse 1.5s infinite alternate;
  max-width: 320px;
}
.premium-title {
  font-size: 26px;
  font-weight: 800;
  color: var(--gold1);
  text-shadow: 0 0 12px rgba(255,215,0,0.6);
  margin-bottom: 12px;
}
.reward-amount {
  font-size: 22px;
  font-weight: 700;
  color: #fff;
  margin-top: 8px;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
}
.reward-icon {
  width: 48px;
  height: 48px;
  animation: spin 1.3s linear infinite;
  filter: drop-shadow(0 0 10px rgba(255,255,255,0.8));
}
@keyframes pulse {
  from { box-shadow: 0 0 30px rgba(255,215,0,0.7); }
  to { box-shadow: 0 0 45px rgba(255,215,0,1); }
}
@keyframes spin {
  to { transform: rotate(360deg); }
}
.close-reward-btn {
  margin-top: 20px;
  background: linear-gradient(180deg,#555,#333);
  color: #fff;
  border: none;
  border-radius: 10px;
  font-weight: 600;
  padding: 10px 20px;
  cursor: pointer;
  transition: opacity 0.2s ease;
}
.close-reward-btn:hover {
  opacity: 0.8;
}

/* === –ù–æ–≤—ã–µ –∏–≥—Ä–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏ (–≤—ã–±–æ—Ä —Ü–≤–µ—Ç–∞ / —Å—Ç–æ—Ä–æ–Ω—ã) === */
.side-btn, .color-btn {
  background: linear-gradient(145deg,#3a3a3a,#222);
  border: 2px solid var(--gold1);
  color: var(--gold1);
  border-radius: 12px;
  padding: 10px 20px;
  font-weight: 700;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  margin: 5px;
}
.side-btn:hover, .color-btn:hover {
  transform: scale(1.08);
  box-shadow: 0 0 15px rgba(255,215,0,0.4);
}
.color-btn.red {
  color: #ff4444;
  border-color: #ff4444;
}
.color-btn.black {
  color: #aaa;
  border-color: #aaa;
}
.vs-text {
  font-size: 18px;
  font-weight: 700;
  color: var(--gold1);
  margin: 0 10px;
}
.dice-battle {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}


 /* –ü—Ä–µ–º–∏—É–º —Å—Ç–∏–ª—å –≤–∫–ª–∞–¥–∫–∏ "–ó–∞–¥–∞–Ω–∏—è" –≤ —Ç–≤–æ–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ */
  #tab-3 {
    padding: 14px;
    color: #f5f5f5;
  }

  .task-section {
    background: var(--panel-bg);
    border: 1px solid rgba(255,255,255,0.04);
    border-radius: 18px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.5), inset 0 0 10px rgba(255,255,255,0.03);
    padding: 18px;
    max-width: 420px;
    margin: 14px auto;
    position: relative;
  }

  .section-title {
    font-size: 18px;
    font-weight: 700;
    color: var(--gold1);
    text-align: center;
    margin-bottom: 10px;
    text-shadow: 0 0 10px rgba(255,215,0,0.3);
  }

  .task-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.05);
    border-radius: 12px;
    padding: 10px 12px;
    margin-bottom: 10px;
    transition: all .2s ease;
  }

  .task-item:hover {
    background: rgba(255,255,255,0.06);
    transform: scale(1.01);
  }

  .task-info {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 600;
    font-size: 14px;
    color: #eaeaea;
  }

  .task-info img {
    width: 34px;
    height: 34px;
    border-radius: 8px;
    object-fit: cover;
    box-shadow: 0 0 8px rgba(255,215,0,0.2);
  }

  .task-buttons {
    display: flex;
    gap: 6px;
  }

  .task-btn {
    padding: 6px 10px;
    border-radius: 10px;
    border: none;
    font-weight: 600;
    font-size: 13px;
    cursor: pointer;
    transition: transform 0.15s, box-shadow 0.2s;
  }

  .btn-check {
    background: linear-gradient(180deg,var(--gold1),var(--gold2));
    color: #111;
    box-shadow: 0 4px 14px rgba(255,215,0,0.25);
  }
  .btn-check:hover {
    transform: scale(1.05);
    box-shadow: 0 0 16px rgba(255,215,0,0.4);
  }

  .btn-done {
    background: linear-gradient(145deg, #28a745, #1e7a33);
    color: #fff;
    box-shadow: 0 4px 14px rgba(40,167,69,0.25);
  }
  .btn-done:hover {
    transform: scale(1.05);
    box-shadow: 0 0 16px rgba(40,167,69,0.45);
  }

  .reward {
    font-size: 12px;
    color: #d6c48a;
    margin-top: 3px;
  }

  @media (max-width:420px) {
    .task-item {
      flex-direction: column;
      align-items: flex-start;
    }
    .task-buttons {
      align-self: flex-end;
      margin-top: 8px;
    }
  }
 















/* =========================
   –ù–û–í–´–ô –°–¢–ò–õ–¨: –í–ê–õ–Æ–¢–ù–´–ô –†–Ø–î (TICKET)
   ========================= */
.currency-row {
    display: flex; 
    justify-content: space-between; 
    align-items: center;
    padding: 15px 20px;
    background: var(--panel-bg);
    border-radius: 18px;
    margin: 14px auto;
    max-width: 420px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.5), inset 0 0 10px rgba(255,255,255,0.03);
}

.currency-info {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 18px;
    font-weight: 600;
    color: #f5f5f5;
}
.currency-info img { 
    width: 32px; 
    height: 32px;
    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.6));
}
.currency-info .bal {
    color: var(--gold1); 
    font-size: 20px; 
    font-weight: 700;
}

.plus-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
}
.plus-btn img {
    width: 36px;
    height: 36px;
    filter: drop-shadow(0 0 10px rgba(255,215,0,0.8));
    transition: transform 0.2s;
}
.plus-btn img:active {
    transform: scale(0.9);
}


/* =========================
   –ù–û–í–´–ô –°–¢–ò–õ–¨: –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–û–ö–£–ü–ö–ò
   ========================= */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 1000;
    display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
}

.modal-overlay.open {
    display: flex !important;
}

.buy-tickets-modal-content {
    background: var(--panel-bg);
    border: 2px solid var(--gold2);
    border-radius: 25px;
    padding: 25px;
    max-width: 350px;
    width: 90%;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8), inset 0 0 15px rgba(255, 215, 0, 0.1);
    transform: scale(0.9);
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    position: relative;
}

.modal-overlay.open .buy-tickets-modal-content {
    transform: scale(1);
    opacity: 1;
}

.modal-close-btn {
    position: absolute;
    top: 10px;
    right: 15px;
    background: none;
    border: none;
    font-size: 28px;
    color: var(--gold2);
    cursor: pointer;
    line-height: 1;
}

.buy-input {
    width: 100%;
    padding: 12px;
    margin-bottom: 15px;
    border-radius: 12px;
    border: 2px solid #555;
    background: #1e1e1e;
    color: #f5f5f5;
    font-size: 16px;
    font-weight: 500;
    text-align: center;
    outline: none;
}

.buy-btn {
    width: 100%;
    background: linear-gradient(180deg, #26a17b, #1e7e61); /* –ó–µ–ª–µ–Ω—ã–π –¥–ª—è USDT –ø–æ–∫—É–ø–∫–∏ */
    border: none;
    padding: 14px 0;
    border-radius: 16px;
    font-weight: 700;
    font-size: 16px;
    cursor: pointer;
    color: #fff;
    box-shadow: 0 6px 20px rgba(38, 161, 123, 0.5);
    margin-top: 10px;
    transition: transform 0.2s, opacity 0.2s;
}

.buy-btn:hover:not(:disabled) {
    transform: translateY(-2px);
}

/* –°—Ç–∏–ª—å –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ 'Ticket' (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ ticket.png - —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ) */
.fall-coin.ticket {
    background-image: url('ticket.png');
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    width: 30px;
    height: 30px;
    text-shadow: none;
    color: transparent; 
    filter: drop-shadow(0 0 8px rgba(0, 150, 255, 0.6)); /* –ì–æ–ª—É–±–∞—è —Ç–µ–Ω—å */
}
</style>
</head>
<body>
<div class="app">
  <div id="sound-toggle" style="position:fixed;right:12px;top:10px;z-index:300;">
    <button id="sound-btn" style="background:none;border:none;color:#ffd700;font-size:20px;cursor:pointer;padding:8px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.4);">üîä</button>
  </div>
  <div class="tabs" id="main-tabs">
    <div id="tab-1" class="tab active">
      <div class="balance-top">
        <img src="Coin.png" alt="Coin"><div class="bal" id="coin-balance">0</div>
        <img src="Toncoin.png" alt="TON"><div class="bal" id="ton-balance">0.00</div>
        <img src="USDT.png" alt="USDT"><div class="bal" id="usdt-balance">0.00</div>
      </div>
      <div class="section-box" id="promo-box">
        <h3>üéÅ –ü—Ä–æ–º–æ–∫–æ–¥</h3>
        <p>–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –±–æ–Ω—É—Å–∞</p>
        <div class="promo-input">
          <input id="promo" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥">
          <button id="promo-apply">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>
        <div id="promo-message" class="promo-message"></div>
      </div>
      <div class="section-box" id="ads-box">
        <h3>üì∫ –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∫–ª–∞–º—ã</h3>
        <p>–ï–∂–µ–¥–Ω–µ–≤–Ω–æ –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ <strong>20</strong> —Ä–µ–∫–ª–∞–º. –ö–∞–∂–¥–∞—è –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞ ‚Äî +1 Coin</p>
        <button id="watch-ad-btn" class="watch-btn">‚ñ∂ –°–º–æ—Ç—Ä–µ—Ç—å</button>
        <div id="ads-progress-bar"><div id="ads-progress-bar-inner"></div></div>
        <p style="text-align:center;color:var(--gold1);margin-top:8px;">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ: <span id="ads-count">0</span>/20</p>
      </div>
      <div class="section-box riddle-box" id="riddle-section">
        <h3>üß© –ó–∞–≥–∞–¥–∫–∞ –¥–Ω—è</h3>
        <p id="riddle-question">–ß—Ç–æ –∏–º–µ–µ—Ç –∫–ª—é—á–∏, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å –Ω–∏ –æ–¥–Ω—É –¥–≤–µ—Ä—å?</p>
        <div class="riddle-input">
          <input id="riddle-answer" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç">
          <button id="riddle-btn">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
        </div>
        <div id="riddle-msg" style="margin-top:10px;display:none;" class="msg"></div>
      </div>
      <div class="section-box" id="daily-login-box">
        <h3>üéâ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—Ö–æ–¥</h3>
        <p>–°–º–æ—Ç—Ä–∏—Ç–µ –≤–∏–¥–µ–æ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å!</p>
        <div id="daily-rewards" style="display:flex; flex-wrap:wrap; justify-content:center; gap:6px; margin:12px 0;">
          <div class="day-cell" data-day="1"><img src="coin.png" style="width:18px;"> 1</div>
          <div class="day-cell" data-day="2"><img src="coin.png" style="width:18px;"> 2</div>
          <div class="day-cell" data-day="3"><img src="coin.png" style="width:18px;"> 3</div>
          <div class="day-cell" data-day="4"><img src="coin.png" style="width:18px;"> 4</div>
          <div class="day-cell" data-day="5"><img src="coin.png" style="width:18px;"> 5</div>
          <div class="day-cell" data-day="6"><img src="coin.png" style="width:18px;"> 6</div>
          <div class="day-cell" data-day="7"><img src="coin.png" style="width:18px;"> 7</div>
        </div>
        <button id="daily-login-btn">–ü–û–õ–£–ß–ò–¢–¨ –ë–û–ù–£–°</button>
      </div>


        

<div class="section-box">
  <h3>üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –ö–æ–º–±–æ</h3>
  <p>–°–æ–±–µ—Ä–∏—Ç–µ –∫–æ–º–±–æ –∏ –ø–æ–ª—É—á–∏—Ç–µ +5 Coin, +0.05 USDT </p>
  
  <div id="combo-cards">
    </div>

  <p id="combo-message" style="margin-top:15px; font-weight:600; text-align:center;"></p>
  <p id="combo-next-reset" style="font-size:12px; color:#aaa; text-align:center;"></p>
</div>

</div>




    <div id="tab-2" class="tab">

      <div class="currency-row">
        <div class="currency-info">
          <img src="ticket.png" alt="Ticket">
          <span>–ë–∞–ª–∞–Ω—Å:</span>
          <div class="bal" id="ticket-balance">0</div>
          <span>Ticket</span>
        </div>
        <button id="open-buy-tickets-modal" class="plus-btn">
          <img src="plus.png" alt="–ü–æ–ø–æ–ª–Ω–∏—Ç—å">
        </button>
      </div>
<!-- üéÆ –ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ –º–∏–Ω–∏-–∏–≥—Ä—ã -->
<div class="section-box" id="games-section">
  <h3>üé∞ –ò–≥—Ä–æ–≤–æ–π –¶–µ–Ω—Ç—Ä</h3>
  <p>–°—Ç–æ–∏–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –∏–≥—Ä—ã: <strong>1 Ticket</strong></p>

  <div class="games-grid">
    <button class="game-card" data-game="cups">üé© –°—Ç–∞–∫–∞–Ω—á–∏–∫–∏</button>
    <button class="game-card" data-game="dice">üé≤ –ö—É–±–∏–∫–∏</button>
    <button class="game-card" data-game="coinflip">ü™ô –û—Ä–µ–ª –∏ —Ä–µ—à–∫–∞</button>
    <button class="game-card" data-game="roulette">üé° –†—É–ª–µ—Ç–∫–∞</button>
  </div>
</div>

<!-- ü™© –û–∫–Ω–æ —Å–∞–º–æ–π –∏–≥—Ä—ã -->
<div class="game-modal-overlay" id="game-modal">
  <div class="game-modal-content" id="game-modal-content">
    <div class="game-visual" id="game-visual"></div>
    <p id="game-status" class="game-status-text"></p>
  </div>
</div>

<!-- üéÅ –û–∫–Ω–æ –Ω–∞–≥—Ä–∞–¥—ã -->
<div class="reward-modal-overlay" id="reward-modal">
  <div class="reward-content">
    <div class="premium-title" id="reward-title">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</div>
    <div class="reward-amount" id="reward-amount"></div>
    <button class="close-reward-btn" id="close-reward-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

 </div>




<div id="tab-3" class="tab">


  <!-- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ -->
  <div class="task-section">
    <div class="section-title"><span class="emoji">üìÖ</span> –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</div>

    <div class="task-item" data-task="visit-channel">
      <div class="task-info">
        <span>üîó –ü–æ—Å–µ—Ç–∏—Ç—å –∫–∞–Ω–∞–ª</span>
      </div>
      <div class="task-buttons">
        <a href="https://t.me/testkanal1921" target="_blank" class="task-btn btn-check">–ü–µ—Ä–µ–π—Ç–∏</a>
        <button class="task-btn btn-done">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</button>
      </div>
    </div>

    <div class="task-item" data-task="visit-chat">
      <div class="task-info">
        <span>üí¨ –ü–æ—Å–µ—Ç–∏—Ç—å —á–∞—Ç</span>
      </div>
      <div class="task-buttons">
        <a href="https://t.me/testchat19191" target="_blank" class="task-btn btn-check">–ü–µ—Ä–µ–π—Ç–∏</a>
        <button class="task-btn btn-done">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</button>
      </div>
    </div>

    <div class="task-item" data-task="play-game">
      <div class="task-info">
        <span>üéÆ –°—ã–≥—Ä–∞–π –≤ 1 –∏–≥—Ä—É</span>
      </div>
      <div class="task-buttons">
        <button class="task-btn btn-check">–ò–≥—Ä–∞—Ç—å</button>
        <button class="task-btn btn-done">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</button>
      </div>
    </div>

    <div class="task-item" data-task="watch-ad">
      <div class="task-info">
        <span>üì∫ –ü–æ—Å–º–æ—Ç—Ä–∏ 1 —Ä–µ–∫–ª–∞–º—É</span>
      </div>
      <div class="task-buttons">
        <button class="task-btn btn-check">–°–º–æ—Ç—Ä–µ—Ç—å</button>
        <button class="task-btn btn-done">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</button>
      </div>
    </div>
  </div>

  <!-- –ü–æ–¥–ø–∏—Å–∫–∞ -->
  <div class="task-section">
    <div class="section-title"><span class="emoji">üì¢</span> –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª</div>

    <div class="task-item" data-task="daily-combo">
      <div class="task-info">
        <img src="Crypto_Daily_Combo_bot.png" alt="">
        <div>
          Dayli Combo
          <div class="reward">–ù–∞–≥—Ä–∞–¥–∞: +5 Coin</div>
        </div>
      </div>
      <div class="task-buttons">
        <a href="https://t.me/Crypto_Daily_Combo_bot" target="_blank" class="task-btn btn-check">–ü–µ—Ä–µ–π—Ç–∏</a>
        <button class="task-btn btn-done">–ü—Ä–æ–≤–µ—Ä–∫–∞</button>
      </div>
    </div>
  </div>

  <!-- –ú–∏–Ω–∏ –∏–≥—Ä—ã -->
  <div class="task-section">
    <div class="section-title"><span class="emoji">üéÆ</span> –ú–∏–Ω–∏-–∏–≥—Ä—ã</div>

    <div class="task-item" data-task="labrador">
      <div class="task-info">
        <img src="labrador.png" alt="">
        <div>
          Labrador Adventures
          <div class="reward">–ù–∞–≥—Ä–∞–¥–∞: +5 Coin</div>
        </div>
      </div>
      <div class="task-buttons">
        <a href="https://t.me/LabradorAdventuresBot/start?startapp=ref_ZGWD9UA40Y" target="_blank" class="task-btn btn-check">–ò–≥—Ä–∞—Ç—å</a>
        <button class="task-btn btn-done">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</button>
      </div>
    </div>
  </div>
</div>


    <div id="tab-4" class="tab">
      <div class="wallet-container">
        <h1 class="wallet-title">–ú–æ–π –ö–æ—à–µ–ª–µ–∫</h1>
        <button id="connect-ton-wallet" style="padding:10px 15px; border-radius:12px; background:linear-gradient(180deg,#00c8ff,#006bbd); color:#fff; font-weight:600; cursor:pointer;">–ü–æ–¥–∫–ª—é—á–∏—Ç—å TON –∫–æ—à–µ–ª–µ–∫</button>
        <p id="ton-wallet-address" style="margin-top:6px; font-size:14px; opacity:0.8;"></p>
        <div class="wallet-grid">
          <div class="wallet-card gold">
            <img src="Coin.png" class="wallet-icon" alt="Coin">
            <div class="wallet-info">
              <span class="wallet-name">Coins</span>
              <span class="wallet-balance" id="coinBalance">0</span>
            </div>
          </div>
          <div class="wallet-card ton">
            <img src="Toncoin.png" class="wallet-icon" alt="TON">
            <div class="wallet-info">
              <span class="wallet-name">TON</span>
              <span class="wallet-balance" id="tonBalance">0.00</span>
            </div>
          </div>
          <div class="wallet-card usdt">
            <img src="USDT.png" class="wallet-icon" alt="USDT">
            <div class="wallet-info">
              <span class="wallet-name">USDT</span>
              <span class="wallet-balance" id="usdtBalance">0.00</span>
            </div>
          </div>
        </div>

        <div class="premium-section" style="margin-top:25px; max-width:420px;">
          <h2>ü™ô –í—ã–≤–æ–¥ Coin</h2>
          <div class="conversion">
            <span style="color:#f5f5f5;">–ö—É—Ä—Å: 1000 Coin = 0.5 TON</span>
          </div>
          <div class="withdraw-form">
            <label for="withdraw-ton" style="display:block;margin-bottom:5px;text-align:left;font-size:14px;color:var(--gold2);">–ê–¥—Ä–µ—Å TON –∫–æ—à–µ–ª—å–∫–∞:</label>
            <input type="text" id="withdraw-ton" placeholder="UQ... –∏–ª–∏ EQ..." value="">

            <label for="withdraw-amount" style="display:block;margin-bottom:5px;text-align:left;font-size:14px;color:var(--gold2);">–°—É–º–º–∞ Coin:</label>
            <div class="amount-row">
              <input type="number" id="withdraw-amount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É Coin" min="1000">
              <button id="withdraw-max">MAX</button>
            </div>
            
            <label for="withdraw-memo" style="display:block;margin-top:10px;margin-bottom:5px;text-align:left;font-size:14px;color:var(--gold2);">MEMO (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
            <input type="text" id="withdraw-memo" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π">

            <button id="withdraw-btn">–í–´–í–ï–°–¢–ò COIN</button>
            <div id="withdraw-message" class="withdraw-message" style="display:none;"></div>
          </div>
        </div>

      </div>

      <div class="premium-section" style="margin-top:20px; max-width:420px;">
          <h2>üìä –ò—Å—Ç–æ—Ä–∏—è –û–ø–µ—Ä–∞—Ü–∏–π</h2>
          <div id="history-filters" class="filter-buttons">
              <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
              <button class="filter-btn" data-filter="reward">–ù–∞–≥—Ä–∞–¥—ã</button>
              <button class="filter-btn" data-filter="withdraw">–í—ã–≤–æ–¥—ã</button>
          </div>
          <div class="history-table-container">
              <table class="history-table" id="transaction-history-table">
                  <thead>
                      <tr>
                          <th>–î–∞—Ç–∞</th>
                          <th>–°—É–º–º–∞</th>
                          <th>–í–∞–ª—é—Ç–∞</th>
                          <th>–¢–∏–ø</th>
                          <th>–ö–æ—à–µ–ª–µ–∫</th>
                          <th>MEMO</th>
                      </tr>
                  </thead>
                  <tbody>
                      </tbody>
              </table>
          </div>
          <p id="no-history-msg" style="margin-top:15px; display:none; color:#9E9E9E;">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞.</p>
      </div>

    </div>

    <div id="tab-5" class="tab">
      <div class="section-box">
        <h3>üõ†Ô∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à–µ –ø—Ä–µ–º–∏–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ!</p>
        <p style="margin-top:20px; font-size:12px; color:#888;"> –í–µ—Ä—Å–∏—è: 1.0.25 (2025) </p>
      </div>
    </div>
  </div>

  <div class="tab-buttons">
    <button class="tab-btn active" data-tab="tab-1"><span class="emoji">üí∞</span><span class="label">–ó–∞—Ä–∞–±–æ—Ç–æ–∫</span></button>
    <button class="tab-btn" data-tab="tab-2"><span class="emoji">üéÆ</span><span class="label">–ò–≥—Ä—ã</span></button>
    <button class="tab-btn" data-tab="tab-3"><span class="emoji">üìù</span><span class="label">–ó–∞–¥–∞–Ω–∏—è</span></button>

    <button class="tab-btn" data-tab="tab-4"><span class="emoji">üíº</span><span class="label">–ö–æ—à–µ–ª–µ–∫</span></button>
    <button class="tab-btn" data-tab="tab-5"><span class="emoji">üõ†Ô∏è</span><span class="label">–ò–Ω—Ñ–æ</span></button>
  </div>
</div>

<div id="buy-tickets-modal-overlay" class="modal-overlay">
  <div class="buy-tickets-modal-content">
    <button id="close-buy-tickets-modal" class="modal-close-btn">&times;</button>
    <h3 style="margin-bottom: 20px;">üí∞ –ü—Ä–µ–º–∏–∞–ª—å–Ω–∞—è –ü–æ–∫—É–ø–∫–∞ Ticket</h3>
    
    <p style="text-align: center; font-weight: 600; color: #f5f5f5; font-size:15px;">
      –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –∫—É—Ä—Å: 
      <span style="color:var(--gold1);">1 Ticket</span> = 
      <span style="color:#26a17b; font-weight:700;">0.1 USDT</span>
    </p>

    <div style="margin: 20px 0;">
      <label for="tickets-amount" style="display: block; margin-bottom: 8px; font-size: 14px; color: var(--gold2); text-align:center;">
        –í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ Ticket, –∫–æ—Ç–æ—Ä–æ–µ –í—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏:
      </label>
      <input type="number" id="tickets-amount" class="buy-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" min="1" value="100">
    </div>

    <p style="text-align: center; font-size: 15px; margin-bottom: 15px; font-weight: 500;">
      –°—É–º–º–∞ –∫ —Å–ø–∏—Å–∞–Ω–∏—é (USDT): 
      <span id="usdt-cost" style="font-weight: 700; color:#26a17b;">1.00</span>
    </p>

    <button id="buy-tickets-btn" class="buy-btn">
      –ö–£–ü–ò–¢–¨ <span id="buy-tickets-display">100</span> TICKET
    </button>
    <div id="buy-message" class="withdraw-message" style="min-height:20px;"></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
<script>
/* =========================== State management =========================== */
let coinBalance = parseInt(localStorage.getItem('coinBalance')) || 0;
let tonBalance = parseFloat(localStorage.getItem('tonBalance')) || 0.00;
let usdtBalance = parseFloat(localStorage.getItem('usdtBalance')) || 0.00;
let adsCount = parseInt(localStorage.getItem('adsCount')) || 0;
const maxAds = 20;
let currentFilter = localStorage.getItem('historyFilter') || 'all'; // 'all', 'reward', 'withdraw'
let transactionHistory = JSON.parse(localStorage.getItem('transactionHistory')) || [];

// New currency state for Ticket (Fixed rate to 0.1 USDT)
let ticketBalance = parseInt(localStorage.getItem('ticketBalance')) || 0;
const TICKET_RATE_USDT = 0.1; // 1 Ticket = 0.1 USDT (–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

// --- –í–ê–®–ò –î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–´–ï –ü–†–û–ú–û–ö–û–î–´ ---
// –í—ã –º–æ–∂–µ—Ç–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–ª—è—Ç—å —Å–≤–æ–∏ –∫–æ–¥—ã.
const validPromoCodes = [
    'PREMIUM25',
    'WELCOME24',
    'MEGAHYPE',
    'TICKETBOOST' 
]; 
// –í—Å–µ –∫–æ–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ –í–ï–†–•–ù–ò–ô –†–ï–ì–ò–°–¢–†
// ------------------------------------


/* =========================== Audio (WebAudio synth, offline, light) =========================== */
const AudioCtx = window.AudioContext || window.webkitAudioContext;
let audioCtx = null;
let soundEnabled = true;

function initAudio(){
    if(audioCtx) return;
    audioCtx = new AudioCtx();
    // create master gain
    window.masterGain = audioCtx.createGain();
    masterGain.gain.value = 0.9; // global volume control
    masterGain.connect(audioCtx.destination);
    // ambient: gentle stereo pad using 2 oscillators and slow LFO -> gain
    const ambGain = audioCtx.createGain();
    ambGain.gain.value = 0.04; // very low volume
    ambGain.connect(masterGain);

    const osc1 = audioCtx.createOscillator();
    osc1.type = 'sine';
    osc1.frequency.value = 110; // low note
    const osc1Gain = audioCtx.createGain();
    osc1Gain.gain.value = 0.02;
    osc1.connect(osc1Gain);
    osc1Gain.connect(ambGain);

    const osc2 = audioCtx.createOscillator();
    osc2.type = 'sine';
    osc2.frequency.value = 110.15; // slightly detuned
    const osc2Gain = audioCtx.createGain();
    osc2Gain.gain.value = 0.02;
    osc2.connect(osc2Gain);
    osc2Gain.connect(ambGain);

    const lfo = audioCtx.createOscillator();
    lfo.type = 'triangle';
    lfo.frequency.value = 0.05; // very slow LFO for subtle volume variation

    lfo.connect(osc1Gain.gain);
    lfo.connect(osc2Gain.gain);

    osc1.start();
    osc2.start();
    lfo.start();
}

function playClick(){
    if(!soundEnabled) return;
    initAudio();
    const osc = audioCtx.createOscillator();
    const gainNode = audioCtx.createGain();

    osc.type = 'square';
    osc.frequency.setValueAtTime(440, audioCtx.currentTime);
    osc.frequency.linearRampToValueAtTime(340, audioCtx.currentTime + 0.05);

    gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
    gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.05);

    osc.connect(gainNode);
    gainNode.connect(masterGain);
    osc.start(audioCtx.currentTime);
    osc.stop(audioCtx.currentTime + 0.05);
}

function playBling(){
    if(!soundEnabled) return;
    initAudio();
    const now = audioCtx.currentTime;
    const osc = audioCtx.createOscillator();
    const gainNode = audioCtx.createGain();

    osc.type = 'triangle';
    osc.frequency.setValueAtTime(800, now);
    osc.frequency.exponentialRampToValueAtTime(1200, now + 0.05);

    gainNode.gain.setValueAtTime(0.5, now);
    gainNode.gain.exponentialRampToValueAtTime(0.0001, now + 0.15);

    osc.connect(gainNode);
    gainNode.connect(masterGain);
    osc.start(now);
    osc.stop(now + 0.15);
}

document.getElementById('sound-btn').addEventListener('click', ()=>{
    soundEnabled = !soundEnabled;
    document.getElementById('sound-btn').textContent = soundEnabled ? 'üîä' : 'üîá';
});

/* =========================== Animation for falling coin/ton/usdt/ticket (–û–ë–ù–û–í–õ–ï–ù–û) =========================== */
function createCurrencyAnimation(currency, amount){
    const count = Math.min(Math.abs(Math.ceil(amount)), 30);
    // –û–±–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è 'ticket'
    const symbolMap = { 'coin':'üí∞', 'ton':'üíé', 'usdt':'üíµ', 'ticket':'üé´' }; 
    const cssClass = { 'coin':'', 'ton':'ton', 'usdt':'usdt', 'ticket':'ticket' }; // –ö–ª–∞—Å—Å 'ticket' –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
    const symbol = symbolMap[currency] || 'üí∞';
    const className = 'fall-coin ' + (cssClass[currency] || '');
    const container = document.body;
    
    for(let i=0; i<count; i++){
        const coin = document.createElement('div');
        // –û–±–Ω–æ–≤–ª–µ–Ω–æ, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ñ–æ–Ω –¥–ª—è Ticket (—Å–º. CSS)
        coin.className = className;
        coin.textContent = (currency === 'ticket' && className.includes('ticket')) ? '' : symbol; 

        const left = Math.random()*85 + 5;
        coin.style.left = left + 'vw';
        coin.style.top = '-40px';
        coin.style.fontSize = (18 + Math.random()*18) + 'px';
        container.appendChild(coin);
        
        const duration = 2000 + Math.random()*1200;
        coin.style.transition = `transform ${duration}ms linear, opacity 400ms linear ${duration-400}ms`;

        requestAnimationFrame(()=> {
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–∞–¥–µ–Ω–∏—è –∏ –≤—Ä–∞—â–µ–Ω–∏—è
            coin.style.transform = `translateY(${window.innerHeight + 120}px) rotate(${(Math.random()*360)}deg)`;
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è —Å–±–æ—Ä–∞ (–µ—Å–ª–∏ –Ω–∞–¥–æ)
        coin.addEventListener('click', ()=>{
            if(currency === 'coin'){
                coinBalance++;
                localStorage.setItem('coinBalance', coinBalance);
            } else if(currency === 'ton'){
                tonBalance = +(tonBalance + 0.01).toFixed(2);
                localStorage.setItem('tonBalance', tonBalance);
            } else if(currency === 'usdt'){
                usdtBalance = +(usdtBalance + 0.01).toFixed(2);
                localStorage.setItem('usdtBalance', usdtBalance);
            } else if(currency === 'ticket'){
                ticketBalance++;
                localStorage.setItem('ticketBalance', ticketBalance);
            }
            updateAllBalances();
            try{ playBling(); }catch(e){}
            coin.remove();
        });

        // –£–¥–∞–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
        setTimeout(()=>{
            try{ coin.remove(); }catch(e){}
        }, duration + 800);
    }
}


/* =========================== Balances update (–û–ë–ù–û–í–õ–ï–ù–û) =========================== */
function updateAllBalances(){
    const cb = coinBalance, tb = tonBalance, ub = usdtBalance;
    // –≤–µ—Ä—Ö–Ω–∏–µ –±–∞–ª–∞–Ω—Å—ã
    const topCoin = document.getElementById('coin-balance');
    const topTon = document.getElementById('ton-balance');
    const topUsdt = document.getElementById('usdt-balance');
    const topTicket = document.getElementById('ticket-balance'); // –î–û–ë–ê–í–õ–ï–ù–û
    
    if(topCoin) topCoin.textContent = cb;
    if(topTon) topTon.textContent = tb.toFixed(2);
    if(topUsdt) topUsdt.textContent = ub.toFixed(2);
    if(topTicket) topTicket.textContent = ticketBalance; // –û–ë–ù–û–í–õ–ï–ù–ò–ï TICKET

    // –∫–æ—à–µ–ª–µ–∫
    const wCoin = document.getElementById('coinBalance');
    const wTon = document.getElementById('tonBalance');
    const wUsdt = document.getElementById('usdtBalance');

    if(wCoin) wCoin.textContent = cb;
    if(wTon) wTon.textContent = tb.toFixed(2);
    if(wUsdt) wUsdt.textContent = ub.toFixed(2);
}

/* =========================== Transaction History =========================== */
function addTransaction(amount, currency, type, wallet, memo, source){
    const now = new Date();
    const dateStr = now.toLocaleDateString('ru-RU') + ', ' + now.toLocaleTimeString('ru-RU');
    transactionHistory.unshift({
        date: dateStr,
        amount: amount,
        currency: currency,
        type: type, // 'reward', 'withdraw', 'deposit'
        wallet: wallet,
        memo: memo,
        source: source
    });
    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –¥–æ 50 –∑–∞–ø–∏—Å–µ–π
    if(transactionHistory.length > 50) transactionHistory.pop();
    localStorage.setItem('transactionHistory', JSON.stringify(transactionHistory));
    renderTransactionHistory();
}

function renderTransactionHistory(){
    const tableBody = document.querySelector('#transaction-history-table tbody');
    const noHistoryMsg = document.getElementById('no-history-msg');
    if (!tableBody) return;

    // –û—á–∏—Å—Ç–∫–∞
    tableBody.innerHTML = '';

    const filteredHistory = transactionHistory.filter(t => currentFilter === 'all' || t.type === currentFilter);

    if (filteredHistory.length === 0) {
        noHistoryMsg.style.display = 'block';
        return;
    }

    noHistoryMsg.style.display = 'none';

    filteredHistory.forEach(t => {
        const row = tableBody.insertRow();
        row.className = `history-type-${t.type}`;
        
        const typeDisplay = { 'reward': '–ù–∞–≥—Ä–∞–¥–∞', 'deposit': '–î–µ–ø–æ–∑–∏—Ç', 'withdraw': '–í—ã–≤–æ–¥' };
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è —Ü–≤–µ—Ç–∞ —Å—É–º–º—ã
        let amountClass = 'history-amount-neutral';
        let amountPrefix = '';
        if (t.type === 'reward' || t.type === 'deposit') {
            amountClass = 'history-amount-plus';
            amountPrefix = '+';
        } else if (t.type === 'withdraw') {
            amountClass = 'history-amount-minus';
            amountPrefix = '-';
        }

        const walletAddress = t.wallet === '-' ? '-' : t.wallet.substring(0, 4) + '...' + t.wallet.substring(t.wallet.length - 4);
        
        const cells = [
            t.date.split(',')[0], // –î–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ –¥–∞—Ç–∞)
            amountPrefix + t.amount, // –°—É–º–º–∞
            t.currency, // –í–∞–ª—é—Ç–∞
            typeDisplay[t.type] || t.type, // –¢–∏–ø
            walletAddress, // –ö–æ—à–µ–ª–µ–∫ (–æ–±—Ä–µ–∑–∞–Ω–Ω—ã–π)
            t.source // MEMO (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏, –æ–ø–∏—Å–∞–Ω–∏–µ)
        ];

        cells.forEach((text, index) => {
            const cell = row.insertCell();
            cell.textContent = text;
            if(index === 1) cell.className = amountClass; // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç –∫ —Å—É–º–º–µ
            // –î–æ–±–∞–≤–ª—è–µ–º title –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞/–æ–ø–∏—Å–∞–Ω–∏—è
            if(index === 4) cell.title = t.wallet === '-' ? t.source : t.wallet;
            if(index === 5) cell.title = t.memo === '-' ? t.source : `–û–ø–∏—Å–∞–Ω–∏–µ: ${t.source}. MEMO: ${t.memo}`;
        });
    });
}
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏—Å—Ç–æ—Ä–∏–∏
document.querySelectorAll('#history-filters .filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        currentFilter = btn.dataset.filter;
        localStorage.setItem('historyFilter', currentFilter);
        document.querySelectorAll('#history-filters .filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderTransactionHistory();
        try{ playClick(); }catch(e){}
    });
});

/* =========================== TON Connect (SIMULATION) =========================== */
function isValidTon(address){
    // –ü—Ä–æ—Å—Ç–æ–µ –¥–µ–º–æ-–≤–∞–ª–∏–¥–∞—Ü–∏—è, —á—Ç–æ –∞–¥—Ä–µ—Å –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –∞–¥—Ä–µ—Å TON (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å UQ/EQ)
    return address && (address.startsWith('UQ') || address.startsWith('EQ'));
}
// TonConnect: connect wallet (SIMULATION)
document.getElementById('connect-ton-wallet').addEventListener('click', async () => {
    try {
        // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –∞–¥—Ä–µ—Å
        const tonAddress = 'UQ' + Array(48).fill(0).map(() => (Math.random() * 16 | 0).toString(16)).join('');
        document.getElementById('ton-wallet-address').textContent = `–ü–æ–¥–∫–ª—é—á–µ–Ω: ${tonAddress.substring(0, 4)}...${tonAddress.substring(tonAddress.length - 4)}`;
        alert('TON –∫–æ—à–µ–ª–µ–∫ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω (–∏–º–∏—Ç–∞—Ü–∏—è)!');
        try{ playBling(); }catch(e){}
    } catch (e) {
        console.error(e);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ TON –∫–æ—à–µ–ª—å–∫–∞.');
    }
});


/* =========================== Utility: Date functions =========================== */
function getUTCDateKey(){
    const now = new Date();
    return now.getUTCFullYear() + '-' + String(now.getUTCMonth()+1).padStart(2,'0') + '-' + String(now.getUTCDate()).padStart(2,'0');
}


/* =========================== Withdraw: check and execute (SIMULATION) =========================== */
document.getElementById('withdraw-max').addEventListener('click', ()=>{
    document.getElementById('withdraw-amount').value = coinBalance;
});
document.getElementById('withdraw-btn').addEventListener('click', ()=>{
    const withdrawTon = document.getElementById('withdraw-ton');
    const withdrawAmount = document.getElementById('withdraw-amount');
    const withdrawMemo = document.getElementById('withdraw-memo');
    const withdrawMessage = document.getElementById('withdraw-message');

    const address = withdrawTon.value.trim();
    const memo = withdrawMemo.value.trim() || '-';
    const amount = parseInt(withdrawAmount.value);

    withdrawMessage.style.display = 'block';
    withdrawMessage.textContent = '';
    withdrawTon.classList.remove('error-field');
    withdrawAmount.classList.remove('error-field');
    
    try { playClick(); } catch(e) {}

    if (!address) {
        withdrawTon.classList.add('error-field');
        withdrawMessage.textContent = '–í–≤–µ–¥–∏—Ç–µ TON –∞–¥—Ä–µ—Å!';
        withdrawMessage.style.color = '#E53935';
        return;
    } else {
        withdrawTon.classList.remove('error-field');
    }

    if (!isValidTon(address)) {
        withdrawTon.classList.add('error-field');
        withdrawMessage.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π TON –∞–¥—Ä–µ—Å!';
        withdrawMessage.style.color = '#E53935';
        return;
    } else {
        withdrawTon.classList.remove('error-field');
    }

    if (!amount || amount < 1) {
        withdrawAmount.classList.add('error-field');
        withdrawMessage.textContent = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É!';
        withdrawMessage.style.color = '#E53935';
        return;
    } else {
        withdrawAmount.classList.remove('error-field');
    }

    if (amount > coinBalance) {
        withdrawMessage.textContent = '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!';
        withdrawMessage.style.color = '#E53935';
        return;
    }

    // –ò–º–∏—Ç–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ API –≤—ã–∑–æ–≤)
    coinBalance -= amount;
    localStorage.setItem('coinBalance', coinBalance);
    updateAllBalances();

    // –î–û–ë–ê–í–õ–ï–ù–ò–ï –û–ü–ï–†–ê–¶–ò–ò –í –ò–°–¢–û–†–ò–Æ
    addTransaction(amount, 'Coin', 'withdraw', address, memo, '–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤');

    withdrawMessage.textContent = `‚úÖ –í—ã–≤–æ–¥ ${amount} Coins –Ω–∞ –∞–¥—Ä–µ—Å ${address} –≤—ã–ø–æ–ª–Ω–µ–Ω!`;
    withdrawMessage.style.color = '#4CAF50';

    // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π
    withdrawAmount.value = '';
    withdrawTon.value = '';
    withdrawMemo.value = '';

    // –ê–Ω–∏–º–∞—Ü–∏—è –º–æ–Ω–µ—Ç
    createCurrencyAnimation('coin', amount);
    try { playBling(); } catch(e) {}
});

/* =========================== Promo: apply promo -> 1 coin + 0.01 TON + 0.01 USDT (–ò–°–ü–†–ê–í–õ–ï–ù–û) =========================== */
document.getElementById('promo-apply').addEventListener('click', applyPromo);
function applyPromo(){
    // –ü—Ä–∏–≤–æ–¥–∏–º –≤–≤–µ–¥–µ–Ω–Ω—ã–π –∫–æ–¥ –∫ –≤–µ—Ä—Ö–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –¥–ª—è –Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É
    const code = document.getElementById('promo').value.trim().toUpperCase();
    const msgEl = document.getElementById('promo-message');
    
    // –°–±—Ä–æ—Å —Å–æ–æ–±—â–µ–Ω–∏–π
    msgEl.style.display='none';
    
    if(!code){
        msgEl.style.display='block';
        msgEl.textContent='‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥';
        msgEl.style.color='#E53935';
        setTimeout(()=>msgEl.style.display='none',2000);
        return;
    }

    // –§–ò–ö–°: –ü–†–û–í–ï–†–ö–ê –ù–ê –î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–û–°–¢–¨ –ö–û–î–ê
    if(!validPromoCodes.includes(code)){
        msgEl.style.display='block';
        msgEl.textContent='‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥.';
        msgEl.style.color='#E53935';
        setTimeout(()=>msgEl.style.display='none',3000);
        return;
    }

    // –§–ò–ö–°: –ü–†–û–í–ï–†–ö–ê –ù–ê –ü–û–í–¢–û–†–ù–û–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –°–ï–ì–û–î–ù–Ø
    const key = 'promoApplied_' + code + '_' + getUTCDateKey();
    if(localStorage.getItem(key) === 'true'){
        msgEl.style.display='block';
        msgEl.textContent=`‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ "${code}" —É–∂–µ –±—ã–ª –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —Å–µ–≥–æ–¥–Ω—è!`;
        msgEl.style.color='#E53935';
        setTimeout(()=>msgEl.style.display='none',3000);
        return;
    }

    // –ò–º–∏—Ç–∞—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–Ω–∞–≥—Ä–∞–¥—ã)
    const coinReward = 1;
    const tonReward = 0.01;
    const usdtReward = 0.01;
    
    coinBalance += coinReward;
    tonBalance = +(tonBalance + tonReward).toFixed(2);
    usdtBalance = +(usdtBalance + usdtReward).toFixed(2);

    localStorage.setItem('coinBalance', coinBalance);
    localStorage.setItem('tonBalance', tonBalance);
    localStorage.setItem('usdtBalance', usdtBalance);
    // –û—Ç–º–µ—á–∞–µ–º –∫–æ–¥ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π —Å–µ–≥–æ–¥–Ω—è
    localStorage.setItem(key, 'true'); 

    updateAllBalances();
    
    // –î–û–ë–ê–í–õ–ï–ù–ò–ï –û–ü–ï–†–ê–¶–ò–ò –í –ò–°–¢–û–†–ò–Æ
    addTransaction(coinReward, 'Coin', 'reward', '-', '-', '–ü—Ä–æ–º–æ–∫–æ–¥: ' + code);
    addTransaction(tonReward, 'TON', 'reward', '-', '-', '–ü—Ä–æ–º–æ–∫–æ–¥: ' + code);
    addTransaction(usdtReward, 'USDT', 'reward', '-', '-', '–ü—Ä–æ–º–æ–∫–æ–¥: ' + code);

    msgEl.style.display='block';
    msgEl.textContent=`üéâ –£—Å–ø–µ—Ö! –ü—Ä–æ–º–æ–∫–æ–¥ "${code}" –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω. +${coinReward} Coin, +${tonReward} TON, +${usdtReward} USDT!`;
    msgEl.style.color='#4CAF50';
    setTimeout(()=>msgEl.style.display='none',3000);

    createCurrencyAnimation('coin', coinReward);
    createCurrencyAnimation('ton', tonReward);
    createCurrencyAnimation('usdt', usdtReward);
    try{ playBling(); }catch(e){}

}


/* =========================== Ads: watch ad -> 1 coin =========================== */
document.getElementById('watch-ad-btn').addEventListener('click', ()=>{
    if(adsCount >= maxAds){
        alert('–í—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∫–ª–∞–º –Ω–∞ —Å–µ–≥–æ–¥–Ω—è!');
        return;
    }

    document.getElementById('watch-ad-btn').disabled = true;
    document.getElementById('watch-ad-btn').textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';

    // –ò–º–∏—Ç–∞—Ü–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∫–ª–∞–º—ã
    setTimeout(()=>{
        adsCount++;
        coinBalance++;
        localStorage.setItem('adsCount', adsCount);
        localStorage.setItem('coinBalance', coinBalance);

        document.getElementById('ads-count').textContent = adsCount;
        document.getElementById('ads-progress-bar-inner').style.width = (adsCount/maxAds*100) + '%';

        updateAllBalances();

        // –î–û–ë–ê–í–õ–ï–ù–ò–ï –û–ü–ï–†–ê–¶–ò–ò –í –ò–°–¢–û–†–ò–Æ
        addTransaction(1, 'Coin', 'reward', '-', '-', '–ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∫–ª–∞–º—ã');

        document.getElementById('watch-ad-btn').textContent = '‚ñ∂ –°–º–æ—Ç—Ä–µ—Ç—å';
        document.getElementById('watch-ad-btn').disabled = false;

        // –ê–Ω–∏–º–∞—Ü–∏—è –º–æ–Ω–µ—Ç—ã
        createCurrencyAnimation('coin', 1);
        try{ playBling(); }catch(e){}
    }, 2000);
});

/* =========================== Riddle: one answer per day (UTC) =========================== */
const riddleBtn = document.getElementById('riddle-btn');
riddleBtn.addEventListener('click', checkRiddle);

function checkRiddle(){
    const key = 'riddleAnswered_' + getUTCDateKey();
    if(localStorage.getItem(key) === 'true'){
        alert('–í—ã —É–∂–µ –æ—Ç–≤–µ—á–∞–ª–∏ –Ω–∞ –∑–∞–≥–∞–¥–∫—É —Å–µ–≥–æ–¥–Ω—è!');
        return;
    }

    const ans = (document.getElementById('riddle-answer').value || '').trim().toLowerCase();
    const msgEl = document.getElementById('riddle-msg');

    if(ans === '' ){
        msgEl.style.display='block';
        msgEl.textContent='‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç';
        msgEl.style.color='#E53935';
        setTimeout(()=>msgEl.style.display='none',2000);
        return;
    }

    if(ans.includes('–ø–∏–∞–Ω–∏') || ans.includes('piano')){
        coinBalance += 5;
        localStorage.setItem('coinBalance', coinBalance);
        updateAllBalances();
        localStorage.setItem(key, 'true');
        
        msgEl.style.display='block';
        msgEl.style.color='#4CAF50';
        msgEl.textContent='‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! +5 Coin';
        
        // –î–û–ë–ê–í–õ–ï–ù–ò–ï –û–ü–ï–†–ê–¶–ò–ò –í –ò–°–¢–û–†–ò–Æ
        addTransaction(5, 'Coin', 'reward', '-', '-', '–ó–∞–≥–∞–¥–∫–∞ –¥–Ω—è');

        createCurrencyAnimation('coin', 5);
        try{ playBling(); }catch(e){}
    } else {
        msgEl.style.display='block';
        msgEl.style.color='#E53935';
        msgEl.textContent='‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞!';
    }
    setTimeout(()=>msgEl.style.display='none',3000);
}

/* =========================== Tabs switching with click sound & ripple =========================== */
document.querySelectorAll('.tab-btn').forEach(btn=>{
    btn.addEventListener('click', function(e){
        try{ playClick(); }catch(e){}

        // ripple effect
        const ripple = document.createElement('span');
        ripple.className = 'ripple';
        const rect = btn.getBoundingClientRect();
        ripple.style.left = (e.clientX - rect.left) + 'px';
        ripple.style.top = (e.clientY - rect.top) + 'px';
        this.appendChild(ripple);
        setTimeout(()=>ripple.remove(), 400);

        // switch tabs
        const targetTab = this.dataset.tab;
        document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
        document.getElementById(targetTab).classList.add('active');
        
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');

        // Render history when tab-4 is opened
        if (targetTab === 'tab-4') {
            renderTransactionHistory();
        }
    });
});








/* ===========================
   –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ö–û–ú–ë–û
   =========================== */

// –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–∏–º–≤–æ–ª–æ–≤ –∫–æ–º–±–æ
const comboSymbols = [
    'combo1.png', 
    'combo2.png', 
    'combo3.png', 
    'combo4.png', 
    'combo5.png', 
    'combo6.png', 
    'combo7.png', 
    'combo8.png'
];
// –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ —É—Å–ø–µ—à–Ω–æ–µ –∫–æ–º–±–æ: 5 Coin (–¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã) –∏ 0.05 USDT (–ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É)
const comboReward = { coin: 5, ton: 0, usdt: 0.05 }; 
const comboLength = 3; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —É–≥–∞–¥–∞—Ç—å

let comboState = JSON.parse(localStorage.getItem('comboState')) || {
    selected: [],       // –í—ã–±—Ä–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–æ–º –∫–∞—Ä—Ç—ã (–∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤)
    correctCombo: [],   // –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–º–±–æ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (–∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤)
    lastReset: 0,       // –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–±—Ä–æ—Å–∞ (–¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏)
    canClaim: true,     // –ú–æ–∂–Ω–æ –ª–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ–º–±–æ (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏)
    claimedToday: false // –°–æ–±—Ä–∞–Ω–æ –ª–∏ –∫–æ–º–±–æ —Å–µ–≥–æ–¥–Ω—è
};

/* ===========================
   –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –ö–û–ú–ë–û
   =========================== */

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è –º–∞—Å—Å–∏–≤–∞
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–±–æ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ
function resetCombo() {
    const now = new Date();
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞—á–∞–ª–æ —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è –ø–æ UTC –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏
    const startOfUTC = new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate())).getTime();
    
    comboState.lastReset = startOfUTC;
    comboState.selected = [];
    comboState.canClaim = true;
    comboState.claimedToday = false; 
    
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∫–æ–º–±–æ –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö 3 —Å–∏–º–≤–æ–ª–æ–≤
    const shuffledSymbols = shuffleArray([...comboSymbols]);
    comboState.correctCombo = shuffledSymbols.slice(0, comboLength);
    
    localStorage.setItem('comboState', JSON.stringify(comboState));
}

/* ===========================
   –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê –ö–û–ú–ë–û
   =========================== */

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è
function updateComboTimer() {
    const now = Date.now();
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Ä–µ–º—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–±—Ä–æ—Å–∞ (–Ω–∞—á–∞–ª–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–Ω—è –ø–æ UTC)
    const tomorrow = new Date();
    tomorrow.setUTCDate(tomorrow.getUTCDate() + 1);
    const nextResetTime = new Date(Date.UTC(tomorrow.getUTCFullYear(), tomorrow.getUTCMonth(), tomorrow.getUTCDate())).getTime();
    
    const timeUntilReset = nextResetTime - now;
    const messageEl = document.getElementById('combo-message');
    const timerEl = document.getElementById('combo-next-reset');
    const cardsContainer = document.getElementById('combo-cards');

    if (!messageEl || !timerEl) return;

    if (timeUntilReset <= 0) {
      // –í—Ä–µ–º—è –≤—ã—à–ª–æ, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –∏ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º
      resetCombo(); 
      generateComboCards(); 
      updateComboTimer();
      return;
    }

    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ —Å–±—Ä–æ—Å–∞
    const hours = Math.floor(timeUntilReset / (1000 * 60 * 60));
    const minutes = Math.floor((timeUntilReset % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((timeUntilReset % (1000 * 60)) / 1000);

    const formattedTime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    timerEl.textContent = `–°–±—Ä–æ—Å —á–µ—Ä–µ–∑: ${formattedTime}`;

    if (comboState.claimedToday) {
      messageEl.textContent = `‚úÖ –ö–æ–º–±–æ —Å–æ–±—Ä–∞–Ω–æ! –í—ã –ø–æ–ª—É—á–∏–ª–∏ +${comboReward.usdt.toFixed(2)} USDT.`;
      messageEl.style.color = '#4CAF50';
      if (cardsContainer) cardsContainer.querySelectorAll('.combo-card').forEach(card => card.style.pointerEvents = 'none');
    } else {
        messageEl.textContent = `–í—ã–±–µ—Ä–∏—Ç–µ ${comboLength} —Å–∏–º–≤–æ–ª–∞ –¥–ª—è –∫–æ–º–±–æ! (–í—ã–±—Ä–∞–Ω–æ: ${comboState.selected.length})`;
        messageEl.style.color = '#d9d9d9';
    }
    
    // –û–±–Ω–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
    setTimeout(updateComboTimer, 1000);
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ HTML
function generateComboCards() {
    const cardsContainer = document.getElementById('combo-cards');
    if (!cardsContainer) return;

    cardsContainer.innerHTML = ''; 
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å–µ 8 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ç–∫–µ
    const allSymbols = shuffleArray([...comboSymbols]); 

    allSymbols.forEach((symbol) => {
      const card = document.createElement('div');
      card.className = 'combo-card';
      card.setAttribute('data-symbol', symbol);
      
      // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ <img> –¥–ª—è —Å–∏–º–≤–æ–ª–æ–≤
      card.innerHTML = `
          <div class="card-overlay">${comboState.claimedToday && comboState.correctCombo.includes(symbol) ? '' : '?'}</div>
          <img src="${symbol}" class="symbol-display" alt="–ö–æ–º–±–æ –∫–∞—Ä—Ç–∞">
      `;
      
      const overlay = card.querySelector('.card-overlay');

      // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ localStorage
      if (comboState.claimedToday) {
         card.style.opacity = 0.5;
         card.classList.remove('selected');
         if (comboState.correctCombo.includes(symbol)) {
             card.classList.add('correct');
             if(overlay) overlay.style.opacity = '0';
         }
      } else {
         if (comboState.selected.includes(symbol)) {
            card.classList.add('selected');
            if(overlay) overlay.style.opacity = '0';
         }
      }

      card.addEventListener('click', () => handleComboClick(card, symbol));
      cardsContainer.appendChild(card);
    });
}

function handleComboClick(card, symbol) {
    // try { playClick(); } catch(e){} // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ playClick –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞

    if (comboState.claimedToday || !comboState.canClaim) {
        return; 
    }

    const overlay = card.querySelector('.card-overlay');
    let shouldCheck = false;

    if (card.classList.contains('selected')) {
      // –û—Ç–º–µ–Ω–∞ –≤—ã–±–æ—Ä–∞
      card.classList.remove('selected');
      comboState.selected = comboState.selected.filter(s => s !== symbol);
      if(overlay) overlay.style.opacity = '1';
    } else if (comboState.selected.length < comboLength) {
      // –í—ã–±–æ—Ä
      card.classList.add('selected');
      comboState.selected.push(symbol);
      if(overlay) overlay.style.opacity = '0';
      if (comboState.selected.length === comboLength) {
        shouldCheck = true;
      }
    }
    
    localStorage.setItem('comboState', JSON.stringify(comboState));
    
    if (shouldCheck) {
      checkCombo();
    }
    updateComboTimer(); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç
}

function checkCombo() {
    if (comboState.claimedToday || !comboState.canClaim) return;

    comboState.canClaim = false; // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–ª–∏–∫–∏ –Ω–∞ –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    
    const selectedSymbols = comboState.selected;
    const correctCombo = comboState.correctCombo;
    const cards = document.querySelectorAll('#combo-cards .combo-card');
    const messageEl = document.getElementById('combo-message');
    
    cards.forEach(card => card.style.pointerEvents = 'none'); // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–∞—Ä—Ç—ã

    // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã —è–≤–ª—è—é—Ç—Å—è —á–∞—Å—Ç—å—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–æ–º–±–æ
    let isCorrect = selectedSymbols.length === comboLength && 
                    selectedSymbols.every(symbol => correctCombo.includes(symbol));

    if (isCorrect) {
      // --- –ö–û–ú–ë–û –°–û–ë–†–ê–ù–û –£–°–ü–ï–®–ù–û ---
      comboState.claimedToday = true;
      
      // –ù–∞–≥—Ä–∞–¥–∞
      coinBalance += comboReward.coin;
      usdtBalance = +(usdtBalance + comboReward.usdt).toFixed(2);
      
      // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
      localStorage.setItem('coinBalance', coinBalance);
      localStorage.setItem('usdtBalance', usdtBalance);
      updateAllBalances();
      
      // –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
      addTransaction(comboReward.coin, 'Coin', 'reward', 'Combo', 'Daily Combo', '–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –ö–æ–º–±–æ');
      addTransaction(comboReward.usdt, 'USDT', 'reward', 'Combo', 'Daily Combo');
      
      // –ê–Ω–∏–º–∞—Ü–∏—è –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ
      createCurrencyAnimation('coin', comboReward.coin);
      createCurrencyAnimation('usdt', comboReward.usdt);
      // try{ playBling(); }catch(e){} // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ playBling –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
      messageEl.textContent = `üéâ –ö–æ–º–±–æ —É–≥–∞–¥–∞–Ω–æ! +${comboReward.usdt.toFixed(2)} USDT!`;
      messageEl.style.color = '#4CAF50';

      // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
      cards.forEach(card => {
        card.classList.remove('selected', 'incorrect');
        if (correctCombo.includes(card.getAttribute('data-symbol'))) {
          card.classList.add('correct');
        } else {
           card.style.opacity = 0.5;
        }
      });

    } else {
      // --- –ö–û–ú–ë–û –ù–ï –°–û–ë–†–ê–ù–û ---
      
      // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö/–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
      cards.forEach(card => {
        const symbol = card.getAttribute('data-symbol');
        if (selectedSymbols.includes(symbol)) {
             // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –±—ã–ª–æ –≤—ã–±—Ä–∞–Ω–æ, –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —ç—Ç–æ
             if (correctCombo.includes(symbol)) {
                 card.classList.add('correct'); 
             } else {
                 card.classList.add('incorrect'); 
             }
        }
        card.classList.remove('selected'); 
      });
      
      messageEl.textContent = '‚ùå –ù–µ–≤–µ—Ä–Ω–æ! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∑–∞–≤—Ç—Ä–∞.';
      messageEl.style.color = '#E53935';

      // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞—Ä—Ç –∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º
      setTimeout(() => {
         comboState.selected = []; 
         comboState.canClaim = true; 
         
         cards.forEach(card => {
            card.classList.remove('correct', 'incorrect', 'selected');
            card.style.opacity = 1;
            card.style.pointerEvents = 'auto';
            
            const overlay = card.querySelector('.card-overlay');
            if(overlay) overlay.style.opacity = '1';
         });
         
         localStorage.setItem('comboState', JSON.stringify(comboState));
         updateComboTimer(); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
      }, 3000); 
    }

    localStorage.setItem('comboState', JSON.stringify(comboState));
    updateComboTimer(); 
}
  
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–±–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
function initComboState() {
    const storedState = localStorage.getItem('comboState');
    if (storedState) {
        comboState = JSON.parse(storedState);
        
        const now = new Date();
        const startOfUTC = new Date(Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate())).getTime();
        
        // –ï—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–±—Ä–æ—Å –±—ã–ª —Ä–∞–Ω—å—à–µ –Ω–∞—á–∞–ª–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è –ø–æ UTC, —Ç–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º
        if (comboState.lastReset < startOfUTC) {
            resetCombo(); 
        } 
    } else {
        resetCombo(); // –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
    }
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
    generateComboCards();
    updateComboTimer();
}

/* ===========================
   –î–û–ë–ê–í–õ–ï–ù–ò–ï –í DOMContentLoaded
   =========================== */

// –í—Å—Ç–∞–≤—å—Ç–µ –≤—ã–∑–æ–≤ initComboState() –≤ –≤–∞—à –≥–ª–∞–≤–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ DOMContentLoaded
document.addEventListener('DOMContentLoaded', ()=> {
    // ... –≤–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ ...
    initComboState(); 
});













/* =========================== Daily login (streak) =========================== */
let dailyStreak = parseInt(localStorage.getItem('dailyStreak')) || 0;
let lastLoginDate = localStorage.getItem('lastLoginDate') || '';

function updateDailyCells(){
    document.querySelectorAll('.day-cell').forEach(cell=>{
        const day = parseInt(cell.dataset.day);
        if(day <= dailyStreak) cell.classList.add('active');
        else cell.classList.remove('active');
    });
}
updateDailyCells();

document.getElementById('daily-login-btn').addEventListener('click', ()=>{
    const today = new Date();
    const todayKey = today.getUTCFullYear()+'-'+String(today.getUTCMonth()+1).padStart(2,'0')+'-'+String(today.getUTCDate()).padStart(2,'0');

    if(lastLoginDate === todayKey){
        alert('–í—ã —É–∂–µ –ø–æ–ª—É—á–∏–ª–∏ –±–æ–Ω—É—Å —Å–µ–≥–æ–¥–Ω—è!');
        return;
    }

    const yesterday = new Date();
    yesterday.setUTCDate(yesterday.getUTCDate()-1);
    const yesterdayKey = yesterday.getUTCFullYear()+'-'+String(yesterday.getUTCMonth()+1).padStart(2,'0')+'-'+String(yesterday.getUTCDate()).padStart(2,'0');

    if(lastLoginDate === yesterdayKey){
        dailyStreak++;
    } else {
        dailyStreak = 1;
    }

    if(dailyStreak > 7) dailyStreak = 1;

    lastLoginDate = todayKey;
    localStorage.setItem('dailyStreak', dailyStreak);
    localStorage.setItem('lastLoginDate', lastLoginDate);

    let reward = 10 + (dailyStreak - 1) * 5; // 10, 15, 20...
    if(dailyStreak === 7) reward += 50; // –ë–æ–Ω—É—Å –∑–∞ 7 –¥–Ω–µ–π

    coinBalance += reward;
    localStorage.setItem('coinBalance', coinBalance);

    updateAllBalances();
    updateDailyCells();

    // –î–û–ë–ê–í–õ–ï–ù–ò–ï –û–ü–ï–†–ê–¶–ò–ò –í –ò–°–¢–û–†–ò–Æ
    addTransaction(reward, 'Coin', 'reward', '-', '-', '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—Ö–æ–¥ (–¥–µ–Ω—å ' + dailyStreak + ')');
    
    alert(`–ë–æ–Ω—É—Å –ø–æ–ª—É—á–µ–Ω! +${reward} Coin –∑–∞ ${dailyStreak} –¥–µ–Ω—å(–¥–Ω—è) –ø–æ–¥—Ä—è–¥!`);
    createCurrencyAnimation('coin', reward);
    try{ playBling(); }catch(e){}
});


/* =========================== Ticket Purchase Logic =========================== */

function initTicketPurchase() {
    const buyModalOverlay = document.getElementById('buy-tickets-modal-overlay');
    const ticketsAmountInput = document.getElementById('tickets-amount');
    const usdtCostDisplay = document.getElementById('usdt-cost');
    const buyTicketsBtn = document.getElementById('buy-tickets-btn');
    const buyTicketsDisplay = document.getElementById('buy-tickets-display');
    const buyMessageEl = document.getElementById('buy-message');

    if (!buyTicketsBtn) {
        console.error("–ö–Ω–æ–ø–∫–∞ –ø–æ–∫—É–ø–∫–∏ Ticket –Ω–µ –Ω–∞–π–¥–µ–Ω–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –≤—Å—Ç–∞–≤–ª–µ–Ω HTML-–∫–æ–¥ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞.");
        return; 
    }

    function calculateCost(amount) {
        return (amount * TICKET_RATE_USDT).toFixed(2); 
    }

    function updateModalDisplays() {
        const amount = parseInt(ticketsAmountInput.value) || 0;
        const cost = parseFloat(calculateCost(amount));
        
        usdtCostDisplay.textContent = cost.toFixed(2);
        buyTicketsDisplay.textContent = amount;

        if (cost > usdtBalance) {
            buyTicketsBtn.disabled = true;
            buyTicketsBtn.style.opacity = '0.5';
        } else {
            buyTicketsBtn.disabled = false; 
            buyTicketsBtn.style.opacity = '1';
        }
    }

    // 1. Open Modal
    document.getElementById('open-buy-tickets-modal').addEventListener('click', () => {
        buyModalOverlay.classList.add('open');
        ticketsAmountInput.value = '100'; 
        buyMessageEl.textContent = '';
        buyTicketsBtn.disabled = false; // –°–Ω–∏–º–∞–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
        updateModalDisplays();
        try { playClick(); } catch(e) {}
    });

    // 2. Close Modal
    document.getElementById('close-buy-tickets-modal').addEventListener('click', () => {
        buyModalOverlay.classList.remove('open');
        try { playClick(); } catch(e) {}
    });

    // 3. Update cost on input change
    ticketsAmountInput.addEventListener('input', () => {
        let value = parseInt(ticketsAmountInput.value);
        if (isNaN(value) || value < 1) {
            value = 1; 
        }
        ticketsAmountInput.value = value;
        updateModalDisplays();
    });

    // 4. Purchase Logic
    buyTicketsBtn.addEventListener('click', () => {
        const amount = parseInt(ticketsAmountInput.value);
        const cost = parseFloat(calculateCost(amount));
        buyMessageEl.textContent = ''; 

        if (amount <= 0 || isNaN(amount)) {
            buyMessageEl.textContent = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ Ticket!';
            buyMessageEl.style.color = '#E53935';
            return;
        }

        if (cost > usdtBalance) {
            buyMessageEl.textContent = '‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ USDT –¥–ª—è –ø–æ–∫—É–ø–∫–∏!';
            buyMessageEl.style.color = '#E53935';
            try { playClick(); } catch(e) {}
            return;
        }

        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏
        usdtBalance = +(usdtBalance - cost).toFixed(2);
        ticketBalance += amount;
        
        localStorage.setItem('usdtBalance', usdtBalance);
        localStorage.setItem('ticketBalance', ticketBalance);
        
        updateAllBalances();
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: –≤—ã–≤–æ–¥ USDT –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ Ticket
        addTransaction(cost, 'USDT', 'withdraw', 'Buy Ticket', amount + ' Ticket', '–ü–æ–∫—É–ø–∫–∞ Ticket');
        addTransaction(amount, 'Ticket', 'reward', '-', cost + ' USDT', '–ü–æ–∫—É–ø–∫–∞ Ticket'); 
        
        buyMessageEl.textContent = `üéâ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –í—ã –ø–æ–ª—É—á–∏–ª–∏ ${amount} Ticket!`;
        buyMessageEl.style.color = '#4CAF50';
        
        createCurrencyAnimation('ticket', amount); 

        // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É (–ø–æ–∫–∞ –Ω–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å–Ω–æ–≤–∞) –∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
        buyTicketsBtn.disabled = true;
        buyTicketsBtn.style.opacity = '0.5';
        setTimeout(() => {
            buyModalOverlay.classList.remove('open');
        }, 2000);

        try { playBling(); } catch(e) {}
    });
}








/* ============================================================
   üéÆ –ü–†–ï–ú–ò–£–ú –ú–ò–ù–ò-–ò–ì–†–´ ‚Äî –° –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ú –í–´–ë–û–†–û–ú
============================================================ */
const gameModal = document.getElementById("game-modal");
const gameVisual = document.getElementById("game-visual");
const gameStatus = document.getElementById("game-status");
const rewardModal = document.getElementById("reward-modal");
const rewardTitle = document.getElementById("reward-title");
const rewardAmountEl = document.getElementById("reward-amount");
const closeRewardBtn = document.getElementById("close-reward-btn");

/* === –ü–£–õ –ù–ê–ì–†–ê–î === */
const rewardsPool = [
  { chance: 10, reward: null },
  { chance: 40, reward: { type: "coin", amount: 1 } },
  { chance: 10, reward: { type: "ticket", amount: 2 } },
  { chance: 5,  reward: { type: "coin", amount: 30 } },
  { chance: 5,  reward: { type: "usdt", amount: 0.15 } },
  { chance: 5,  reward: { type: "ton", amount: 0.1 } },
  { chance: 10, reward: { type: "coin", amount: getRandomInt(1,5) } },
  { chance: 5,  reward: { type: "ton", amount: +(Math.random() * 0.05).toFixed(2) } },
  { chance: 5,  reward: { type: "usdt", amount: +(Math.random() * 0.05).toFixed(2) } }
];

/* === –ö–ù–û–ü–ö–ò –ò–ì–† === */
document.querySelectorAll(".game-card").forEach(btn=>{
  btn.addEventListener("click", async ()=>{
    const gameType = btn.dataset.game;

    if (ticketBalance < 1) {
      alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ Ticket –¥–ª—è –∏–≥—Ä—ã!");
      return;
    }

    ticketBalance -= 1;
    localStorage.setItem("ticketBalance", ticketBalance);
    updateAllBalances();
    startGameAnimation(gameType);
  });
});

/* === –ó–ê–ü–£–°–ö –ò–ì–†–´ === */
function startGameAnimation(type){
  gameModal.classList.add("open");
  gameVisual.innerHTML = "";
  gameStatus.textContent = "–ò–≥—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è...";

  let animation;
  switch(type){
    case "cups": animation = animateCups; break;
    case "dice": animation = animateDice; break;
    case "coinflip": animation = animateCoin; break;
    case "roulette": animation = animateRoulette; break;
  }

  animation((win)=>{
    gameModal.classList.remove("open");
    if (!win) {
      showRewardModal("üò¢ –ù–µ –ø–æ–≤–µ–∑–ª–æ!", `<span style='color:#aaa;'>–ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑</span>`);
      addTransaction(0,"Ticket","reward","-","-",`–ò–≥—Ä–∞: ${getGameName(type)} (–º–∏–º–æ)`);
    } else {
      const reward = getRandomReward();
      applyReward(reward,type);
    }
  });
}

/* === –ò–ì–†–ê: –°–¢–ê–ö–ê–ù–ß–ò–ö–ò === */
function animateCups(callback){
  gameVisual.innerHTML = `
    <div class="cups-container">
      <div class="cup" data-index="0"></div>
      <div class="cup" data-index="1"></div>
      <div class="cup" data-index="2"></div>
    </div>`;
  
  gameStatus.textContent = "–ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Å—Ç–∞–∫–∞–Ω—ã...";

  const cups = [...gameVisual.querySelectorAll(".cup")];
  const hiddenIndex = Math.floor(Math.random() * 3);

  // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω–¥–µ–∫—Å —Å –≤—ã–∏–≥—Ä—ã—à–µ–º (–ª–æ–≥–∏—á–µ—Å–∫–∏ ‚Äî –º–æ–Ω–µ—Ç–∞ –ø–æ–¥ —Å—Ç–∞–∫–∞–Ω–æ–º)
  cups.forEach((c,i)=>{
    c.style.left = `${i*60}px`;
    c.style.animation = "shuffle 1s infinite alternate";
  });

  setTimeout(()=>{
    cups.forEach(c=>c.style.animation="none");
    gameStatus.textContent = "–í—ã–±–µ—Ä–∏ —Å—Ç–∞–∫–∞–Ω ‚òùÔ∏è";
    cups.forEach(c=>{
      c.addEventListener('click', ()=>{
        const chosen = +c.dataset.index;
        const win = chosen === hiddenIndex;
        c.classList.add("lift");
        gameStatus.textContent = win ? "üéâ –¢—ã —É–≥–∞–¥–∞–ª!" : "üò¢ –ú–∏–º–æ!";
        setTimeout(()=>callback(win),1200);
      }, { once: true });
    });
  },2000);
}

/* === –ò–ì–†–ê: –ö–£–ë–ò–ö–ò (–±–∏—Ç–≤–∞) === */
function animateDice(callback){
  gameVisual.innerHTML = `
    <div class="dice-battle">
      <div class="dice player-dice"></div>
      <div class="vs-text">VS</div>
      <div class="dice enemy-dice"></div>
    </div>`;
  const player = gameVisual.querySelector(".player-dice");
  const enemy = gameVisual.querySelector(".enemy-dice");
  let rolls = 0;

  const roll = setInterval(()=>{
    rolls++;
    player.textContent = getRandomInt(1,6);
    enemy.textContent = getRandomInt(1,6);
    if(rolls>12){
      clearInterval(roll);
      const p = +player.textContent, e = +enemy.textContent;
      if (p>e) gameStatus.textContent = `–¢—ã –ø–æ–±–µ–¥–∏–ª üéâ (${p} –ø—Ä–æ—Ç–∏–≤ ${e})`;
      else if (p<e) gameStatus.textContent = `–ü—Ä–æ–∏–≥—Ä—ã—à üò¢ (${p} –ø—Ä–æ—Ç–∏–≤ ${e})`;
      else gameStatus.textContent = `–ù–∏—á—å—è (${p} = ${e})`;
      setTimeout(()=>callback(p>e),1200);
    }
  },100);
}

/* === –ò–ì–†–ê: –û–†–ï–õ –ò –†–ï–®–ö–ê === */
function animateCoin(callback){
  gameVisual.innerHTML = `
    <div class="choose-side">
      <button class="side-btn" data-side="–û—Ä–µ–ª">–û—Ä–µ–ª</button>
      <button class="side-btn" data-side="–†–µ—à–∫–∞">–†–µ—à–∫–∞</button>
    </div>`;
  gameStatus.textContent = "–í—ã–±–µ—Ä–∏ —Å—Ç–æ—Ä–æ–Ω—É!";
  const buttons = gameVisual.querySelectorAll(".side-btn");

  buttons.forEach(b=>{
    b.addEventListener('click', ()=>{
      const chosen = b.dataset.side;
      gameStatus.textContent = "–ë—Ä–æ—Å–∞–µ–º –º–æ–Ω–µ—Ç—É...";
      gameVisual.innerHTML = `<div class="coin-flip"></div>`;
      const coin = gameVisual.querySelector(".coin-flip");
      coin.classList.add("spinning");

      setTimeout(()=>{
        coin.classList.remove("spinning");
        const side = Math.random()<0.5 ? "–û—Ä–µ–ª" : "–†–µ—à–∫–∞";
        coin.textContent = side;
        gameStatus.textContent = side === chosen ? "üéâ –¢—ã —É–≥–∞–¥–∞–ª!" : "üò¢ –ú–∏–º–æ!";
        setTimeout(()=>callback(side === chosen),1000);
      },2500);
    }, { once: true });
  });
}

/* === –ò–ì–†–ê: –†–£–õ–ï–¢–ö–ê === */
function animateRoulette(callback){
  gameVisual.innerHTML = `
    <div class="choose-color">
      <button class="color-btn Yellow">–ñ–µ–ª—Ç—ã–π</button>
      <button class="color-btn black">–ß—ë—Ä–Ω—ã–π</button>
    </div>`;
  gameStatus.textContent = "–í—ã–±–µ—Ä–∏ —Ü–≤–µ—Ç!";
  const buttons = gameVisual.querySelectorAll(".color-btn");

  buttons.forEach(b=>{
    b.addEventListener('click', ()=>{
      const choice = b.classList.contains("red") ? "red" : "black";
      gameVisual.innerHTML = `<div class="roulette-wheel"></div>`;
      const wheel = gameVisual.querySelector(".roulette-wheel");
      let deg = 0;
      const spin = setInterval(()=>{ deg += 20; wheel.style.transform = `rotate(${deg}deg)`; },40);
      gameStatus.textContent = "–ö—Ä—É—Ç–∏—Ç—Å—è –∫–æ–ª–µ—Å–æ...";

      setTimeout(()=>{
        clearInterval(spin);
        const isRed = Math.random() < 0.5;
        gameStatus.textContent = isRed ? "–ñ–µ–ª—Ç—ã–π!" : "–ß—ë—Ä–Ω—ã–π!";
        const win = (isRed && choice==="red") || (!isRed && choice==="black");
        setTimeout(()=>callback(win),1200);
      },2500);
    }, { once: true });
  });
}

/* === –ù–ê–ì–†–ê–î–´ === */
function getRandomReward(){
  const roll = Math.random()*100;
  let sum = 0;
  for(const item of rewardsPool){
    sum += item.chance;
    if(roll<sum) return item.reward;
  }
  return null;
}

function applyReward(reward,game){
  let imgSrc="";
  switch(reward.type){
    case "coin": coinBalance+=reward.amount; localStorage.setItem("coinBalance",coinBalance); imgSrc="Coin.png"; break;
    case "ticket": ticketBalance+=reward.amount; localStorage.setItem("ticketBalance",ticketBalance); imgSrc="ticket.png"; break;
    case "usdt": usdtBalance=+(usdtBalance+reward.amount).toFixed(2); localStorage.setItem("usdtBalance",usdtBalance); imgSrc="USDT.png"; break;
    case "ton": tonBalance=+(tonBalance+reward.amount).toFixed(2); localStorage.setItem("tonBalance",tonBalance); imgSrc="Toncoin.png"; break;
  }
  updateAllBalances();
  showRewardModal("üéâ –ü–æ–±–µ–¥–∞!", `<img src="${imgSrc}" class="reward-icon"> +${reward.amount} ${reward.type.toUpperCase()}`);
  addTransaction(reward.amount,reward.type.toUpperCase(),"reward","-","-",`–ò–≥—Ä–∞: ${getGameName(game)}`);
}

/* === –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï === */
function getGameName(id){
  switch(id){
    case "cups": return "–°—Ç–∞–∫–∞–Ω—á–∏–∫–∏";
    case "dice": return "–ö—É–±–∏–∫–∏";
    case "coinflip": return "–û—Ä–µ–ª –∏ —Ä–µ—à–∫–∞";
    case "roulette": return "–†—É–ª–µ—Ç–∫–∞";
    default: return "–ò–≥—Ä–∞";
  }
}
function showRewardModal(title,html){
  rewardTitle.innerHTML=title;
  rewardAmountEl.innerHTML=html;
  rewardModal.classList.add("open");
}
closeRewardBtn.addEventListener("click",()=>rewardModal.classList.remove("open"));
function getRandomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min;}




















/* =========================== Initial load =========================== */
document.addEventListener('DOMContentLoaded', ()=>{
    // –ó–∞–ø—É—Å–∫ –ª–æ–≥–∏–∫–∏ –ø–æ–∫—É–ø–æ–∫ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
    initTicketPurchase(); 

    // –ü—Ä–æ—á–µ–µ
    generateComboCards(); // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∫–∞—Ä—Ç–æ—á–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è
    initComboState();
    
    adsCount = parseInt(localStorage.getItem('adsCount')) || 0;
    document.getElementById('ads-count').textContent = adsCount;
    document.getElementById('ads-progress-bar-inner').style.width = (adsCount/maxAds*100) + '%';
    
    // –§–ò–ö–°: –Ø–≤–Ω–æ –≤–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –ø—Ä–æ–º–æ–∫–æ–¥–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    const promoButton = document.getElementById('promo-apply');
    if (promoButton) {
        promoButton.disabled = false;
    }
});


/* === Premium Tasks Logic (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è) === */
function showTaskMessage(msg, color="#ffd700") {
  const div = document.createElement('div');
  div.textContent = msg;
  div.style.position = 'fixed';
  div.style.bottom = '90px';
  div.style.left = '50%';
  div.style.transform = 'translateX(-50%)';
  div.style.background = 'linear-gradient(145deg, rgba(0,0,0,0.9), rgba(30,30,30,0.95))';
  div.style.border = `1px solid ${color}`;
  div.style.color = color;
  div.style.padding = '10px 20px';
  div.style.borderRadius = '12px';
  div.style.fontWeight = '600';
  div.style.boxShadow = `0 0 15px ${color}55`;
  div.style.zIndex = '9999';
  div.style.opacity = '0';
  div.style.transition = 'opacity .3s ease, transform .3s ease';
  document.body.appendChild(div);
  setTimeout(() => { div.style.opacity = '1'; div.style.transform = 'translate(-50%, -10px)'; }, 50);
  setTimeout(() => { div.style.opacity = '0'; div.style.transform = 'translate(-50%, 20px)'; }, 2000);
  setTimeout(() => div.remove(), 2500);
}

document.querySelectorAll('#tab-3 .task-item').forEach(item => {
  const task = item.dataset.task;
  const checkBtn = item.querySelector('.btn-check');
  const doneBtn = item.querySelector('.btn-done');

  // –ö–æ–≥–¥–∞ –Ω–∞–∂–∞–ª–∏ "–ü–µ—Ä–µ–π—Ç–∏", "–ò–≥—Ä–∞—Ç—å" –∏–ª–∏ "–°–º–æ—Ç—Ä–µ—Ç—å" ‚Üí —Ñ–∏–∫—Å–∏—Ä—É–µ–º –ø–æ–ø—ã—Ç–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  if (checkBtn) {
    checkBtn.addEventListener('click', () => {
      localStorage.setItem('task_' + task, 'in-progress');
      showTaskMessage('üîÑ –ó–∞–¥–∞–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ ‚Äî –ø—Ä–æ–≤–µ—Ä—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–∑–∂–µ');
    });
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  if (doneBtn) {
    doneBtn.addEventListener('click', () => {
      const status = localStorage.getItem('task_' + task);

      if (!status) {
        showTaskMessage('‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–π–¥–∏ –ø–æ —Å—Å—ã–ª–∫–µ –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏ –¥–µ–π—Å—Ç–≤–∏–µ!', '#ff5555');
        return;
      }

      if (status === 'done') {
        showTaskMessage('‚ÑπÔ∏è –ó–∞–¥–∞–Ω–∏–µ —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ', '#999');
        return;
      }

      // –≠–º—É–ª—è—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
      doneBtn.disabled = true;
      doneBtn.textContent = '‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞...';

      setTimeout(() => {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
        localStorage.setItem('task_' + task, 'done');
        doneBtn.textContent = '‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ';
        doneBtn.style.opacity = '0.6';
        doneBtn.style.cursor = 'default';

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–≥—Ä–∞–¥—É
        let reward = 1;
        if (task === 'daily-combo' || task === 'labrador') reward = 5;

        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞–≥—Ä–∞–¥—É
        let coinBalance = parseInt(localStorage.getItem('coinBalance') || 0);
        coinBalance += reward;
        localStorage.setItem('coinBalance', coinBalance);

        if (typeof updateAllBalances === 'function') updateAllBalances();
        if (typeof createCurrencyAnimation === 'function') createCurrencyAnimation('coin', reward);
        if (typeof addTransaction === 'function') addTransaction(reward, 'Coin', 'reward', '-', '-', '–ó–∞–¥–∞–Ω–∏—è');

        showTaskMessage(`üí∞ +${reward} Coin –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ`);
      }, 1500);
    });
  }

  // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
  const saved = localStorage.getItem('task_' + task);
  if (saved === 'done') {
    doneBtn.textContent = '‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ';
    doneBtn.disabled = true;
    doneBtn.style.opacity = '0.6';
  }
});




/* Ensure balances reflect initial state */
updateAllBalances();

// –û–¢–û–ë–†–ê–ñ–ê–ï–ú –ò–°–¢–û–†–ò–Æ –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
renderTransactionHistory(); 

 // TonConnect (–Ω–µ–±–æ–ª—å—à–æ–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
  const tonConnectInstance = new TonConnect.TonConnect({
    manifestUrl: "https://yourdomain.com/tonconnect-manifest.json" // –∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π URL
  });

  let connectedWallet = null;

  // –û—Å—Ç–∞–≤–ª–µ–Ω–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫, –µ—Å–ª–∏ –≥–¥–µ-—Ç–æ –≤ HTML –µ—Å—Ç—å —Å—Ç–∞—Ä–∞—è –∫–Ω–æ–ø–∫–∞ 'connect-wallet'
  // if (document.getElementById('connect-wallet')) {
  //   document.getElementById('connect-wallet').addEventListener('click', async () => {
  //     try {
  //       connectedWallet = await tonConnectInstance.connect();
  //       document.getElementById('wallet-address').textContent = connectedWallet.account.address;
  //       // updateBalance();
  //     } catch (e) {
  //       console.error(e);
  //     }
  //   });
  // }
</script>
</body>
</html>


